<!DOCTYPE html>
<html lang="vi">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Thi·ªáp Ch√∫c M·ª´ng Sinh Nh·∫≠t</title>
  <!-- Lottie Animation Library -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/lottie-web/5.12.2/lottie.min.js"></script>
  <style>
  @import url('https://fonts.googleapis.com/css2?family=Be+Vietnam+Pro:wght@400;500;700&family=Poppins:wght@300;400;600;700&family=Dancing+Script:wght@400;600;700&family=Merriweather:wght@300;400;700&family=Pacifico&display=swap');

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      background: linear-gradient(135deg, #66eab5 0%, #4ba258 50%, #f093fb 100%);
      font-family: 'Be Vietnam Pro', 'Poppins', 'Segoe UI', Arial, sans-serif;
      overflow: hidden;
      position: relative;
    }

    /* M√†n 0: Loading Screen */
    .loading-screen {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: #ffffff;
      z-index: 9999;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      font-family: 'Courier New', monospace;
    }

    .loading-screen.hidden {
      animation: screenFadeOut 1s ease-out forwards;
    }

    @keyframes screenFadeOut {
      0% {
        opacity: 1;
        transform: scale(1);
      }

      100% {
        opacity: 0;
        transform: scale(1.1);
        pointer-events: none;
      }
    }

    /* Code editor container */
    .code-container {
      width: 80%;
      max-width: 800px;
      background: #1e1e1e;
      border-radius: 10px;
      padding: 20px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
      margin-bottom: 40px;
      position: relative;
      overflow: hidden;
    }

    .code-header {
      display: flex;
      gap: 8px;
      margin-bottom: 15px;
    }

    .code-dot {
      width: 12px;
      height: 12px;
      border-radius: 50%;
    }

    .code-dot.red {
      background: #ff5f56;
    }

    .code-dot.yellow {
      background: #ffbd2e;
    }

    .code-dot.green {
      background: #27c93f;
    }

    .code-content {
      color: #d4d4d4;
      font-size: 14px;
      line-height: 1.8;
      min-height: 200px;
      position: relative;
      font-family: 'Fira Mono', 'Consolas', 'Menlo', 'monospace';
    }

    .code-line {
      white-space: pre;
      opacity: 0;
      animation: typeIn 0.1s ease-out forwards;
    }

    @keyframes typeIn {
      to {
        opacity: 1;
      }
    }

    .code-cursor {
      display: inline-block;
      width: 2px;
      height: 18px;
      background: #00ff00;
      animation: blink 0.8s infinite;
      vertical-align: text-bottom;
    }

    @keyframes blink {

      0%,
      50% {
        opacity: 1;
      }

      51%,
      100% {
        opacity: 0;
      }
    }

    /* Syntax highlighting */
    .keyword {
      color: #569cd6;
    }

    .string {
      color: #ce9178;
    }

    .function {
      color: #dcdcaa;
    }

    .comment {
      color: #6a9955;
    }

    .number {
      color: #b5cea8;
    }

    .const {
      color: #4fc1ff;
    }

    /* Loading bar */
    .loading-bar-container {
      width: 80%;
      max-width: 800px;
      margin-bottom: 30px;
    }

    .loading-title {
      color: #00ff00;
      font-size: 1.5em;
      margin-bottom: 15px;
      text-align: center;
      text-shadow: 0 0 10px #00ff00;
      animation: titleGlow 2s ease-in-out infinite;
    }

    @keyframes titleGlow {

      0%,
      100% {
        text-shadow: 0 0 10px #00ff00;
      }

      50% {
        text-shadow: 0 0 20px #00ff00, 0 0 30px #00ff00;
      }
    }

    .loading-bar {
      width: 100%;
      height: 30px;
      background: #1e1e1e;
      border-radius: 15px;
      overflow: hidden;
      border: 2px solid #00ff00;
      box-shadow: 0 0 20px rgba(0, 255, 0, 0.3);
      position: relative;
    }

    .loading-bar-fill {
      height: 100%;
      width: 0%;
      background: linear-gradient(90deg, #00ff00, #00ffff, #00ff00);
      background-size: 200% 100%;
      animation: loadingProgress 1.25s ease-in-out forwards, shimmer 1s linear infinite;
      border-radius: 15px;
      position: relative;
      box-shadow: 0 0 20px rgba(0, 255, 0, 0.8);
    }

    @keyframes loadingProgress {
      0% {
        width: 0%;
      }

      100% {
        width: 100%;
      }
    }

    @keyframes shimmer {
      0% {
        background-position: 0% 0%;
      }

      100% {
        background-position: 200% 0%;
      }
    }

    .loading-percent {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      color: #fff;
      font-weight: bold;
      font-size: 16px;
      text-shadow: 0 0 5px #000;
      z-index: 1;
    }

    /* Success message */
    .success-container {
      display: none;
      text-align: center;
      animation: successAppear 0.5s ease-out;
    }

    @keyframes successAppear {
      0% {
        opacity: 0;
        transform: scale(0.5) rotate(-10deg);
      }

      50% {
        transform: scale(1.1) rotate(5deg);
      }

      100% {
        opacity: 1;
        transform: scale(1) rotate(0deg);
      }
    }

    .success-icon {
      font-size: 120px;
      animation: successBounce 0.6s ease-out;
      filter: drop-shadow(0 0 30px #00ff00);
    }

    @keyframes successBounce {

      0%,
      100% {
        transform: scale(1);
      }

      50% {
        transform: scale(1.3);
      }
    }

    .success-text {
      font-size: 2em;
      color: #00ff00;
      font-weight: bold;
      margin-top: 20px;
      text-shadow: 0 0 20px #00ff00;
      animation: successPulse 1s ease-in-out infinite;
    }

    @keyframes successPulse {

      0%,
      100% {
        transform: scale(1);
      }

      50% {
        transform: scale(1.05);
      }
    }

    /* Simple animated background particles */
    .loading-screen::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-image:
        radial-gradient(circle at 20% 30%, rgba(0, 255, 0, 0.1) 2px, transparent 2px),
        radial-gradient(circle at 60% 70%, rgba(0, 255, 255, 0.1) 2px, transparent 2px),
        radial-gradient(circle at 80% 10%, rgba(0, 255, 0, 0.1) 2px, transparent 2px);
      background-size: 250px 250px, 350px 350px, 300px 300px;
      animation: floatParticles 15s linear infinite;
      z-index: 0;
      opacity: 0.5;
    }

    @keyframes floatParticles {
      0% {
        background-position: 0 0, 0 0, 0 0;
      }

      100% {
        background-position: 250px 250px, -350px 350px, 300px -300px;
      }
    }

    /* Floating particles background */
    body::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-image:
        radial-gradient(circle at 20% 30%, rgba(255, 255, 255, 0.1) 1px, transparent 1px),
        radial-gradient(circle at 60% 70%, rgba(255, 255, 255, 0.1) 1px, transparent 1px),
        radial-gradient(circle at 80% 10%, rgba(255, 255, 255, 0.1) 1px, transparent 1px);
      background-size: 200px 200px, 300px 300px, 250px 250px;
      animation: floatParticles 20s linear infinite;
      z-index: 0;
    }

    @keyframes floatParticles {
      0% {
        background-position: 0 0, 0 0, 0 0;
      }

      100% {
        background-position: 200px 200px, -300px 300px, 250px -250px;
      }
    }

    .card {
      background: rgba(255, 255, 255, 0.95);
      padding: 60px 80px;
      border-radius: 30px;
      box-shadow:
        0 20px 60px rgba(0, 0, 0, 0.15),
        0 0 0 1px rgba(255, 255, 255, 0.5) inset;
      text-align: center;
      position: relative;
      animation: fadeInUp 1.2s ease-out;
      z-index: 10;
      backdrop-filter: blur(10px);
      transform-style: preserve-3d;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }

    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(50px) scale(0.9);
      }

      to {
        opacity: 1;
        transform: translateY(0) scale(1);
      }
    }

    .emoji {
      font-size: 4em;
      animation: gentleBounce 3s ease-in-out infinite;
      display: inline-block;
      filter: drop-shadow(0 5px 15px rgba(255, 107, 107, 0.3));
    }

    @keyframes gentleBounce {

      0%,
      100% {
        transform: translateY(0) scale(1);
      }

      50% {
        transform: translateY(-15px) scale(1.05);
      }
    }

    h1 {
      font-size: 3em;
      font-weight: 700;
      background: linear-gradient(135deg, #ff6b6b 0%, #ff8e53 25%, #ffd93d 50%, #6bcf7f 75%, #4d96ff 100%);
      background-size: 200% 200%;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin: 25px 0;
      animation: gradientShift 4s ease infinite;
      text-transform: none;
      letter-spacing: 2px;
      font-family: 'Be Vietnam Pro', 'Poppins', 'Segoe UI', Arial, sans-serif;
    }

    @keyframes gradientShift {

      0%,
      100% {
        background-position: 0% 50%;
      }

      50% {
        background-position: 100% 50%;
      }
    }

    .message {
      font-size: 1.2em;
      color: #555;
      margin-top: 25px;
      line-height: 1.8;
      font-weight: 300;
    }

    .from-signature {
      font-size: 1em;
      color: #8B4513;
      margin-top: 25px;
      font-family: 'Be Vietnam Pro', 'Pacifico', 'Brush Script MT', cursive;
      font-style: italic;
      opacity: 0.9;
      text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.1);
    }

    .decorative-line {
      height: 3px;
      width: 80px;
      background: linear-gradient(90deg, transparent, #ff8e53, transparent);
      margin: 20px auto;
      border-radius: 10px;
    }

    /* N√∫t b·∫•m chuy·ªÉn m√†n */
    .btn-next {
      margin-top: 30px;
      padding: 15px 40px;
      font-size: 1.2em;
      font-weight: 600;
      color: white;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      border: none;
      border-radius: 50px;
      cursor: pointer;
      box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
      transition: all 0.3s ease;
      font-family: 'Poppins', sans-serif;
      animation: pulse 2s ease-in-out infinite;
    }

    .btn-next:hover {
      transform: translateY(-3px);
      box-shadow: 0 15px 40px rgba(102, 126, 234, 0.6);
    }

    @keyframes pulse {

      0%,
      100% {
        transform: scale(1);
      }

      50% {
        transform: scale(1.05);
      }
    }

    /* Hi·ªáu ·ª©ng m√°y bay */
    .airplane {
      position: fixed;
      font-size: 60px;
      z-index: 1000;
      animation: flyAcross 3s ease-in-out forwards;
      display: none;
    }

    @keyframes flyAcross {
      0% {
        left: -100px;
        top: 20%;
        transform: rotate(-10deg);
      }

      50% {
        top: 50%;
        transform: rotate(0deg);
      }

      100% {
        left: 110%;
        top: 30%;
        transform: rotate(10deg);
      }
    }

    /* M√†n 0.1: Go Screen */
    .go-screen {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, #26992276 0%, #5883b7 50%, #e2d4e4 100%);
      z-index: 999;
      justify-content: center;
      align-items: center;
      flex-direction: column;
      animation: fadeIn 1s ease-in;
    }

    .go-screen.hidden {
      animation: screenFadeOut 1s ease-out forwards;
    }

    .go-container {
      text-align: center;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 30px;
    }

    .go-emoji {
      font-size: 120px;
      animation: gentleBounce 3s ease-in-out infinite;
    }

    .go-title {
      font-size: 3em;
      font-weight: 700;
      background: linear-gradient(135deg, #ff6b6b 0%, #ff8e53 25%, #ffd93d 50%, #6bcf7f 75%, #4d96ff 100%);
      background-size: 200% 200%;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      animation: gradientShift 4s ease infinite;
      color: white;
    }

    .go-btn {
      padding: 20px 50px;
      font-size: 1.5em;
      font-weight: 700;
      color: white;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      border: 3px solid rgba(255, 255, 255, 0.3);
      border-radius: 60px;
      cursor: pointer;
      box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
      transition: all 0.3s ease;
      font-family: 'Poppins', sans-serif;
      animation: pulse 2s ease-in-out infinite;
    }

    .go-btn:hover {
      transform: translateY(-5px) scale(1.1);
      box-shadow: 0 15px 40px rgba(102, 126, 234, 0.6);
      background: linear-gradient(135deg, #764ba2 0%, #667eea 100%);
    }

    .go-btn:active {
      transform: translateY(-2px) scale(1.05);
    }

    /* M√†n h√¨nh th·ªïi n·∫øn */
    .candle-screen {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, #1e3c72 0%, #2a5298 50%, #7e22ce 100%);
      z-index: 999;
      justify-content: center;
      align-items: center;
      flex-direction: column;
      animation: fadeIn 1s ease-in;
    }

    .cake-container {
      text-align: center;
      position: relative;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 20px;
    }

    /* Ch√∫ m√®o b√™ b√°nh - Lottie Animation */
    .cat-holder {
      width: 250px;
      height: 250px;
      animation: catHappy 3s ease-in-out infinite;
      filter: drop-shadow(0 10px 30px rgba(0, 0, 0, 0.3));
      position: relative;
      z-index: 5;
    }

    #catAnimation {
      width: 100%;
      height: 100%;
    }

    @keyframes catHappy {

      0%,
      100% {
        transform: translateY(0) rotate(-2deg);
      }

      50% {
        transform: translateY(-15px) rotate(2deg);
      }
    }

    /* B√°nh sinh nh·∫≠t tr√™n tay m√®o */
    .cake {
      font-size: 180px;
      position: relative;
      z-index: 10;
      animation: cakeBounce 2s ease-in-out infinite;
      filter: drop-shadow(0 10px 30px rgba(255, 182, 193, 0.5));
    }

    @keyframes cakeBounce {

      0%,
      100% {
        transform: translateY(0) scale(1);
      }

      50% {
        transform: translateY(-10px) scale(1.02);
      }
    }

    .candles {
      position: absolute;
      top: -40px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 40px;
      z-index: 15;
    }

    .candle {
      position: relative;
      width: 30px;
      height: 100px;
      transition: all 0.5s ease;
    }

    .candle.blown .candle-body {
      opacity: 0.6;
      filter: grayscale(0.3);
      transform: scale(0.98);
      animation: candleShake 0.3s ease-in-out;
    }

    @keyframes candleShake {

      0%,
      100% {
        transform: scale(0.98) rotate(0deg);
      }

      25% {
        transform: scale(0.98) rotate(-3deg);
      }

      75% {
        transform: scale(0.98) rotate(3deg);
      }
    }

    /* Khi n·∫øn b·ªã th·ªïi t·∫Øt - ·∫®n ho√†n to√†n ng·ªçn l·ª≠a */
    .candle.blown .flame,
    .candle.blown .wick-glow,
    .candle.blown .flame-light {
      opacity: 0 !important;
      transform: translateX(-50%) scale(0) !important;
      transition: all 0.4s ease-out !important;
      visibility: hidden !important;
      display: none !important;
      animation: none !important;
      /* D·ª´ng m·ªçi animation */
    }

    .candle.blown .flame::before,
    .candle.blown .flame::after {
      opacity: 0 !important;
      display: none !important;
      animation: none !important;
    }

    .candle.blown .smoke {
      opacity: 1 !important;
      animation: smoke-rise 2.5s ease-out forwards !important;
      display: block !important;
      visibility: visible !important;
    }

    /* Th√¢n n·∫øn v·ªõi m√†u s·∫Øc ƒë·∫πp h∆°n */
    .candle-body {
      width: 30px;
      height: 100px;
      background: linear-gradient(to right, #ff6b6b, #ff8787, #ff6b6b);
      border-radius: 3px 3px 0 0;
      position: relative;
      box-shadow:
        inset -5px 0 10px rgba(0, 0, 0, 0.2),
        inset 5px 0 10px rgba(255, 255, 255, 0.3),
        0 5px 15px rgba(255, 107, 107, 0.4);
      transition: all 0.3s ease;
    }

    /* S·ªçc trang tr√≠ tr√™n n·∫øn */
    .candle-body::after {
      content: '';
      position: absolute;
      top: 20%;
      left: 0;
      right: 0;
      height: 4px;
      background: rgba(255, 255, 255, 0.3);
      border-radius: 2px;
    }

    .candle-body::before {
      content: '';
      position: absolute;
      top: -3px;
      left: 50%;
      transform: translateX(-50%);
      width: 32px;
      height: 8px;
      background: radial-gradient(ellipse at center, #ff8787 0%, #ff6b6b 100%);
      border-radius: 50%;
      box-shadow: 0 0 5px rgba(255, 107, 107, 0.8);
    }

    /* B·∫•c n·∫øn */
    .wick {
      position: absolute;
      top: -15px;
      left: 50%;
      transform: translateX(-50%);
      width: 3px;
      height: 15px;
      background: linear-gradient(to top, #2c1810, #1a0f08);
      border-radius: 1px;
      z-index: 1;
    }

    /* √Ånh s√°ng b·∫•c n·∫øn */
    .wick-glow {
      position: absolute;
      top: -20px;
      left: 50%;
      transform: translateX(-50%);
      width: 10px;
      height: 10px;
      background: radial-gradient(circle, #ffeb3b, #ff9800);
      border-radius: 50%;
      box-shadow:
        0 0 15px #ffeb3b,
        0 0 25px #ff9800,
        0 0 35px #ff5722;
      animation: glow-pulse 0.15s ease-in-out infinite;
      transition: all 0.5s ease;
      z-index: 2;
    }

    @keyframes glow-pulse {

      0%,
      100% {
        opacity: 1;
        transform: translateX(-50%) scale(1);
      }

      50% {
        opacity: 0.85;
        transform: translateX(-50%) scale(0.95);
      }
    }

    /* Ng·ªçn l·ª≠a 3 l·ªõp ch√¢n th·ª±c */
    .flame {
      position: absolute;
      top: -75px;
      left: 50%;
      transform: translateX(-50%);
      width: 45px;
      height: 65px;
      background: linear-gradient(to top,
          rgba(255, 200, 0, 0.9) 0%,
          rgba(255, 150, 0, 0.95) 30%,
          rgba(255, 100, 0, 0.85) 60%,
          rgba(255, 50, 0, 0.5) 80%,
          rgba(255, 0, 0, 0.2) 100%);
      border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%;
      box-shadow:
        0 0 25px rgba(255, 150, 0, 0.9),
        0 0 45px rgba(255, 100, 0, 0.7),
        0 0 65px rgba(255, 50, 0, 0.5),
        inset 0 0 25px rgba(255, 255, 100, 0.6);
      animation: flame-flicker 0.12s ease-in-out infinite alternate;
      transition: all 0.5s ease;
      z-index: 3;
    }

    .flame::before {
      content: '';
      position: absolute;
      top: 12px;
      left: 50%;
      transform: translateX(-50%);
      width: 28px;
      height: 42px;
      background: linear-gradient(to top,
          rgba(255, 255, 100, 0.95) 0%,
          rgba(255, 200, 0, 0.8) 40%,
          rgba(255, 150, 0, 0.4) 80%,
          transparent 100%);
      border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%;
      animation: inner-flame 0.18s ease-in-out infinite alternate;
    }

    .flame::after {
      content: '';
      position: absolute;
      top: 18px;
      left: 50%;
      transform: translateX(-50%);
      width: 18px;
      height: 32px;
      background: linear-gradient(to top,
          rgba(255, 255, 255, 0.95) 0%,
          rgba(255, 255, 150, 0.9) 50%,
          rgba(255, 200, 0, 0.5) 100%);
      border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%;
      animation: core-flame 0.08s ease-in-out infinite alternate;
    }

    @keyframes flame-flicker {
      0% {
        transform: translateX(-50%) scale(1, 1) rotate(-1deg);
        opacity: 1;
      }

      25% {
        transform: translateX(-48%) scale(1.03, 0.97) rotate(2deg);
      }

      50% {
        transform: translateX(-50%) scale(0.97, 1.03) rotate(-2deg);
      }

      75% {
        transform: translateX(-52%) scale(1.02, 0.98) rotate(1deg);
      }

      100% {
        transform: translateX(-50%) scale(0.98, 1.02) rotate(0deg);
        opacity: 0.96;
      }
    }

    @keyframes inner-flame {
      0% {
        transform: translateX(-50%) scale(1, 1);
      }

      100% {
        transform: translateX(-50%) scale(1.06, 0.94);
      }
    }

    @keyframes core-flame {
      0% {
        transform: translateX(-50%) scale(1, 1);
        opacity: 1;
      }

      100% {
        transform: translateX(-50%) scale(0.93, 1.07);
        opacity: 0.92;
      }
    }

    /* √Ånh s√°ng t·ª´ ng·ªçn l·ª≠a */
    .flame-light {
      position: absolute;
      top: -65px;
      left: 50%;
      transform: translateX(-50%);
      width: 120px;
      height: 120px;
      background: radial-gradient(circle at center,
          rgba(255, 200, 0, 0.4) 0%,
          rgba(255, 150, 0, 0.25) 30%,
          rgba(255, 100, 0, 0.15) 60%,
          transparent 100%);
      border-radius: 50%;
      animation: light-pulse 1.2s ease-in-out infinite alternate;
      pointer-events: none;
      transition: all 0.5s ease;
      z-index: 1;
    }

    @keyframes light-pulse {
      0% {
        transform: translateX(-50%) scale(1);
        opacity: 0.7;
      }

      100% {
        transform: translateX(-50%) scale(1.25);
        opacity: 0.9;
      }
    }

    /* Kh√≥i khi th·ªïi t·∫Øt - n√¢ng cao */
    .smoke {
      position: absolute;
      top: -35px;
      left: 50%;
      transform: translateX(-50%);
      width: 8px;
      height: 50px;
      background: linear-gradient(to top,
          rgba(120, 120, 120, 1) 0%,
          rgba(160, 160, 160, 0.8) 40%,
          rgba(180, 180, 180, 0.5) 70%,
          transparent 100%);
      border-radius: 50%;
      opacity: 0;
      transition: opacity 0.1s ease;
      filter: blur(3px);
      z-index: 20;
    }

    @keyframes smoke-rise {
      0% {
        transform: translateX(-50%) translateY(0) scale(1) rotate(0deg);
        opacity: 1;
        filter: blur(3px);
      }

      30% {
        transform: translateX(-48%) translateY(-40px) scale(1.3) rotate(5deg);
        opacity: 0.8;
        filter: blur(4px);
      }

      60% {
        transform: translateX(-45%) translateY(-80px) scale(1.8) rotate(-5deg);
        opacity: 0.5;
        filter: blur(5px);
      }

      100% {
        transform: translateX(-40%) translateY(-140px) scale(2.5) rotate(10deg);
        opacity: 0;
        filter: blur(6px);
      }
    }

    .instruction {
      margin-top: 50px;
      font-size: 1.8em;
      color: white;
      text-shadow: 0 0 20px rgba(255, 255, 255, 0.5);
      animation: breathe 2s ease-in-out infinite;
      font-weight: 600;
    }

    @keyframes breathe {

      0%,
      100% {
        opacity: 0.8;
        transform: scale(1);
      }

      50% {
        opacity: 1;
        transform: scale(1.05);
      }
    }

    .mic-icon {
      font-size: 60px;
      margin-top: 20px;
      animation: micPulse 1.5s ease-in-out infinite;
    }

    @keyframes micPulse {

      0%,
      100% {
        transform: scale(1);
      }

      50% {
        transform: scale(1.2);
      }
    }

    .success-message {
      display: none;
      font-size: 2.5em;
      color: #FFD700;
      text-shadow: 0 0 30px rgba(255, 215, 0, 0.8);
      margin-top: 30px;
      animation: celebration 1s ease-in-out;
      font-weight: 700;
    }

    @keyframes celebration {
      0% {
        transform: scale(0) rotate(-180deg);
        opacity: 0;
      }

      50% {
        transform: scale(1.2) rotate(10deg);
      }

      100% {
        transform: scale(1) rotate(0deg);
        opacity: 1;
      }
    }

    .hidden {
      display: none !important;
    }

    /* M√†n h√¨nh 3: L·ªùi ch√∫c - Letter Style */
    .wishes-screen {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, #8B7355 0%, #D2B48C 50%, #F5DEB3 100%);
      z-index: 999;
      justify-content: flex-start;
      align-items: center;
      flex-direction: column;
      padding: 40px 20px;
      overflow-y: auto;
      animation: fadeIn 1.5s ease-in;
    }

    .wishes-container {
      max-width: 700px;
      width: 100%;
      text-align: left;
      animation: slideInUp 1s ease-out;
      margin-bottom: 40px;
    }

    @keyframes slideInUp {
      from {
        opacity: 0;
        transform: translateY(50px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    /* Envelope/Letter Header */
    .wishes-title {
      font-size: 2.2em;
      font-weight: 600;
      color: #8B4513;
      text-align: center;
      margin-bottom: 30px;
      font-family: 'Dancing Script', 'Brush Script MT', cursive;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
      animation: titlePulse 3s ease-in-out infinite;
    }

    @keyframes titlePulse {

      0%,
      100% {
        transform: scale(1);
      }

      50% {
        transform: scale(1.02);
      }
    }

    /* Letter Paper Style */
    .wish-card {
      background:
        linear-gradient(90deg, rgba(139, 69, 19, 0.1) 1px, transparent 1px),
        linear-gradient(rgba(139, 69, 19, 0.05) 1px, transparent 1px),
        #FFFEF0;
      background-size: 100% 40px, 100% 40px, 100% 100%;
      background-position: 0 0, 0 0, 0 0;
      padding: 50px 60px;
      border-radius: 5px;
      box-shadow:
        0 10px 40px rgba(0, 0, 0, 0.2),
        inset 0 0 0 1px rgba(139, 69, 19, 0.1);
      margin: 20px 0;
      animation: cardAppear 0.8s ease-out backwards;
      position: relative;
      border: 1px solid rgba(139, 69, 19, 0.2);
    }

    /* Paper texture effect */
    .wish-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-image:
        repeating-linear-gradient(0deg,
          transparent,
          transparent 39px,
          rgba(139, 69, 19, 0.08) 39px,
          rgba(139, 69, 19, 0.08) 40px);
      pointer-events: none;
      border-radius: 5px;
    }

    /* Stamp decoration */
    .wish-card::after {
      content: 'üéÇ';
      position: absolute;
      top: 20px;
      right: 20px;
      font-size: 40px;
      opacity: 0.3;
      transform: rotate(15deg);
    }

    .wish-card:nth-child(2) {
      animation-delay: 0.3s;
    }

    .wish-card:nth-child(3) {
      animation-delay: 0.6s;
    }

    .wish-card:nth-child(4) {
      animation-delay: 0.9s;
    }

    .wish-card:nth-child(5) {
      animation-delay: 1.2s;
    }

    @keyframes cardAppear {
      from {
        opacity: 0;
        transform: translateY(30px) scale(0.95);
      }

      to {
        opacity: 1;
        transform: translateY(0) scale(1);
      }
    }

    .wish-icon {
      font-size: 2em;
      margin-bottom: 15px;
      margin-right: 15px;
      display: inline-block;
      animation: iconFloat 3s ease-in-out infinite;
    }

    @keyframes iconFloat {

      0%,
      100% {
        transform: translateY(0);
      }

      50% {
        transform: translateY(-5px);
      }
    }

    .wish-text {
      font-size: 1.2em;
      color: #4A4A4A;
      line-height: 2;
      font-weight: 400;
      font-family: 'Be Vietnam Pro', 'Merriweather', 'Georgia', Arial, sans-serif;
      text-align: left;
      letter-spacing: 0.5px;
    }

    .wish-text strong {
      color: #8B4513;
      font-weight: 700;
    }

    /* Signature style */
    .final-message {
      margin-top: 40px;
      font-size: 1.8em;
      color: #8B4513;
      font-weight: 700;
      text-align: center;
      font-family: 'Be Vietnam Pro', 'Pacifico', 'Brush Script MT', cursive;
      animation: finalGlow 2s ease-in-out infinite;
      background: #FFFEF0;
      padding: 30px;
      border-radius: 10px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
      border: 2px dashed rgba(139, 69, 19, 0.3);
    }

    @keyframes finalGlow {

      0%,
      100% {
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
      }

      50% {
        box-shadow: 0 15px 40px rgba(139, 69, 19, 0.3);
      }
    }

    /* Gift question inline trong m√†n l·ªùi ch√∫c */
    .gift-question-inline {
      margin-top: 50px;
      background: #FFFEF0;
      padding: 40px;
      border-radius: 10px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
      text-align: center;
      border: 2px solid rgba(139, 69, 19, 0.3);
      animation: bounceIn 1s ease-out;
      animation-delay: 1.5s;
      animation-fill-mode: backwards;
    }

    @keyframes bounceIn {
      0% {
        opacity: 0;
        transform: scale(0.3);
      }

      50% {
        transform: scale(1.05);
      }

      70% {
        transform: scale(0.9);
      }

      100% {
        opacity: 1;
        transform: scale(1);
      }
    }

    .gift-icon-inline {
      font-size: 80px;
      animation: giftShake 2s ease-in-out infinite;
      margin-bottom: 20px;
    }

    @keyframes giftShake {

      0%,
      100% {
        transform: rotate(0deg);
      }

      10%,
      30%,
      50%,
      70%,
      90% {
        transform: rotate(-10deg);
      }

      20%,
      40%,
      60%,
      80% {
        transform: rotate(10deg);
      }
    }

    .gift-title-inline {
      font-size: 1.8em;
      color: #8B4513;
      font-weight: 600;
      margin-bottom: 30px;
      font-family: 'Be Vietnam Pro', 'Georgia', Arial, sans-serif;
    }

    .gift-buttons-inline {
      display: flex;
      gap: 20px;
      justify-content: center;
    }

    .gift-btn-inline {
      padding: 15px 40px;
      font-size: 1.3em;
      font-weight: 600;
      border: none;
      border-radius: 50px;
      cursor: pointer;
      transition: all 0.3s ease;
      font-family: 'Poppins', sans-serif;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    .gift-btn-inline.yes {
      background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
      color: white;
    }

    .gift-btn-inline.yes:hover {
      transform: translateY(-3px) scale(1.05);
      box-shadow: 0 10px 25px rgba(17, 153, 142, 0.4);
    }

    .gift-btn-inline.no {
      background: linear-gradient(135deg, #ee0979 0%, #ff6a00 100%);
      color: white;
    }

    .gift-btn-inline.no:hover {
      transform: translateY(-3px) scale(1.05);
      box-shadow: 0 10px 25px rgba(238, 9, 121, 0.4);
    }

    .gift-question-inline.hidden {
      display: none;
    }

    .hearts-animation {
      position: fixed;
      pointer-events: none;
      z-index: 1001;
    }

    .heart {
      position: fixed;
      font-size: 30px;
      animation: heartFloat 4s ease-in forwards;
      opacity: 0;
    }

    @keyframes heartFloat {
      0% {
        opacity: 0;
        transform: translateY(0) rotate(0deg);
      }

      10% {
        opacity: 1;
      }

      90% {
        opacity: 1;
      }

      100% {
        opacity: 0;
        transform: translateY(-100vh) rotate(360deg);
      }
    }

    /* M√†n h√¨nh 4: Nh·∫≠n qu√† */
    .gift-screen {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
      z-index: 999;
      justify-content: center;
      align-items: center;
      flex-direction: column;
      animation: fadeIn 1s ease-in;
    }

    .gift-question {
      text-align: center;
      animation: bounceIn 1s ease-out;
    }

    @keyframes bounceIn {
      0% {
        opacity: 0;
        transform: scale(0.3);
      }

      50% {
        transform: scale(1.05);
      }

      70% {
        transform: scale(0.9);
      }

      100% {
        opacity: 1;
        transform: scale(1);
      }
    }

    .gift-icon {
      font-size: 120px;
      animation: giftShake 2s ease-in-out infinite;
      margin-bottom: 30px;
    }

    @keyframes giftShake {

      0%,
      100% {
        transform: rotate(0deg);
      }

      10%,
      30%,
      50%,
      70%,
      90% {
        transform: rotate(-10deg);
      }

      20%,
      40%,
      60%,
      80% {
        transform: rotate(10deg);
      }
    }

    .gift-title {
      font-size: 3em;
      color: white;
      font-weight: 700;
      text-shadow: 0 5px 20px rgba(0, 0, 0, 0.3);
      margin-bottom: 40px;
      font-family: 'Be Vietnam Pro', 'Poppins', 'Segoe UI', Arial, sans-serif;
    }

    .gift-buttons {
      display: flex;
      gap: 30px;
    }

    .gift-btn {
      padding: 20px 50px;
      font-size: 1.5em;
      font-weight: 600;
      border: none;
      border-radius: 50px;
      cursor: pointer;
      transition: all 0.3s ease;
      font-family: 'Poppins', sans-serif;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
    }

    .gift-btn.yes {
      background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
      color: white;
    }

    .gift-btn.yes:hover {
      transform: translateY(-5px) scale(1.05);
      box-shadow: 0 15px 40px rgba(17, 153, 142, 0.5);
    }

    .gift-btn.no {
      background: linear-gradient(135deg, #ee0979 0%, #ff6a00 100%);
      color: white;
    }

    .gift-btn.no:hover {
      transform: translateY(-5px) scale(1.05);
      box-shadow: 0 15px 40px rgba(238, 9, 121, 0.5);
    }

    /* 404 Error Screen */
    .error-404 {
      display: none;
      text-align: center;
      animation: errorAppear 0.5s ease-out;
    }

    @keyframes errorAppear {
      0% {
        opacity: 0;
        transform: scale(0.5) rotate(-10deg);
      }

      100% {
        opacity: 1;
        transform: scale(1) rotate(0deg);
      }
    }

    .error-gif {
      width: 300px;
      height: 300px;
      margin: 0 auto 30px;
      border-radius: 20px;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
      animation: gifBounce 2s ease-in-out infinite;
      overflow: hidden;
    }

    .error-gif img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      border-radius: 20px;
    }

    @keyframes gifBounce {

      0%,
      100% {
        transform: translateY(0) scale(1);
      }

      50% {
        transform: translateY(-10px) scale(1.02);
      }
    }

    .error-code {
      font-size: 150px;
      font-weight: 900;
      color: white;
      text-shadow:
        0 0 20px rgba(255, 255, 255, 0.5),
        0 10px 30px rgba(0, 0, 0, 0.5);
      margin-bottom: 20px;
      animation: glitchError 1s ease-in-out infinite;
    }

    @keyframes glitchError {

      0%,
      90%,
      100% {
        transform: translate(0);
      }

      92% {
        transform: translate(-5px, 5px);
      }

      94% {
        transform: translate(5px, -5px);
      }

      96% {
        transform: translate(-5px, -5px);
      }

      98% {
        transform: translate(5px, 5px);
      }
    }

    .error-message {
      font-size: 2em;
      color: white;
      font-weight: 600;
      margin-bottom: 20px;
    }

    .error-emoji {
      font-size: 80px;
      margin: 20px 0;
      animation: sadFace 2s ease-in-out infinite;
    }

    @keyframes sadFace {

      0%,
      100% {
        transform: scale(1);
      }

      50% {
        transform: scale(1.1);
      }
    }

    /* Countdown */
    .countdown-container {
      display: none;
      text-align: center;
      animation: countdownAppear 0.8s ease-out;
    }

    @keyframes countdownAppear {
      0% {
        opacity: 0;
        transform: translateY(30px);
      }

      100% {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .countdown-text {
      font-size: 2em;
      color: white;
      margin-bottom: 30px;
      font-weight: 600;
    }

    .countdown-number {
      font-size: 150px;
      font-weight: 900;
      color: white;
      text-shadow:
        0 0 30px rgba(255, 255, 255, 0.8),
        0 10px 40px rgba(0, 0, 0, 0.5);
      animation: countPulse 1s ease-in-out;
    }

    @keyframes countPulse {
      0% {
        transform: scale(0.5);
        opacity: 0;
      }

      50% {
        transform: scale(1.2);
      }

      100% {
        transform: scale(1);
        opacity: 1;
      }
    }

    /* Wish Form */
    .wish-form-container {
      display: none;
      max-width: 600px;
      width: 90%;
      text-align: center;
      animation: formSlideIn 1s ease-out;
    }

    @keyframes formSlideIn {
      0% {
        opacity: 0;
        transform: translateY(50px) scale(0.9);
      }

      100% {
        opacity: 1;
        transform: translateY(0) scale(1);
      }
    }

    .form-title {
      font-size: 2.5em;
      color: white;
      font-weight: 700;
      margin-bottom: 30px;
      text-shadow: 0 5px 20px rgba(0, 0, 0, 0.3);
    }

    .form-icon {
      font-size: 80px;
      margin-bottom: 20px;
      animation: iconSpin 3s ease-in-out infinite;
    }

    @keyframes iconSpin {

      0%,
      100% {
        transform: rotate(0deg) scale(1);
      }

      50% {
        transform: rotate(10deg) scale(1.1);
      }
    }

    .wish-input {
      width: 100%;
      min-height: 150px;
      padding: 20px;
      font-size: 1.2em;
      border: none;
      border-radius: 20px;
      font-family: 'Be Vietnam Pro', 'Poppins', 'Segoe UI', Arial, sans-serif;
      resize: vertical;
      box-shadow:
        0 10px 30px rgba(0, 0, 0, 0.3),
        inset 0 2px 5px rgba(0, 0, 0, 0.1);
      margin-bottom: 25px;
      transition: all 0.3s ease;
    }

    .wish-input:focus {
      outline: none;
      box-shadow:
        0 15px 40px rgba(255, 255, 255, 0.3),
        inset 0 2px 5px rgba(0, 0, 0, 0.1);
      transform: translateY(-3px);
    }

    .wish-input::placeholder {
      color: #999;
    }

    .submit-btn {
      padding: 18px 60px;
      font-size: 1.4em;
      font-weight: 700;
      color: white;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      border: none;
      border-radius: 50px;
      cursor: pointer;
      font-family: 'Poppins', sans-serif;
      box-shadow: 0 10px 30px rgba(102, 126, 234, 0.5);
      transition: all 0.3s ease;
    }

    .submit-btn:hover {
      transform: translateY(-5px) scale(1.05);
      box-shadow: 0 15px 40px rgba(102, 126, 234, 0.7);
    }

    .submit-btn:active {
      transform: translateY(-2px) scale(1.02);
    }

    /* Success message after submit */
    .submit-success {
      display: none;
      text-align: center;
      animation: successPop 0.8s ease-out;
    }

    @keyframes successPop {
      0% {
        opacity: 0;
        transform: scale(0);
      }

      50% {
        transform: scale(1.2);
      }

      100% {
        opacity: 1;
        transform: scale(1);
      }
    }

    .success-icon {
      font-size: 120px;
      margin-bottom: 30px;
      animation: successRotate 1s ease-out;
    }

    @keyframes successRotate {
      0% {
        transform: rotate(-180deg) scale(0);
      }

      100% {
        transform: rotate(0deg) scale(1);
      }
    }

    .success-title {
      font-size: 3em;
      color: white;
      font-weight: 700;
      text-shadow: 0 5px 20px rgba(0, 0, 0, 0.3);
      margin-bottom: 20px;
    }

    .success-text {
      font-size: 1.5em;
      color: white;
      font-weight: 400;
    }

    /* Music controls */
    .music-toggle {
      position: fixed;
      bottom: 30px;
      right: 30px;
      width: 60px;
      height: 60px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      border: none;
      border-radius: 50%;
      cursor: pointer;
      box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
      z-index: 1000;
      transition: all 0.3s ease;
      animation: musicPulse 2s ease-in-out infinite;
    }

    .music-toggle:hover {
      transform: scale(1.1);
      box-shadow: 0 8px 30px rgba(102, 126, 234, 0.6);
    }

    @keyframes musicPulse {

      0%,
      100% {
        box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
      }

      50% {
        box-shadow: 0 5px 30px rgba(102, 126, 234, 0.8);
      }
    }

    /* Hi·ªáu ·ª©ng ·∫£nh ng·∫´u nhi√™n (GIF, PNG, JPG, WEBP) */
    .random-image {
      position: fixed;
      pointer-events: none;
      object-fit: cover;
      transition: all 0.3s ease;
    }

    .random-image:hover {
      transform: scale(1.1);
    }

    /* Hi·ªáu ·ª©ng ph√°o gi·∫•y nh·∫π nh√†ng */
    .confetti {
      position: fixed;
      width: 8px;
      height: 12px;
      border-radius: 2px;
      animation: confetti-fall 4s ease-in-out infinite;
      opacity: 0.8;
    }

    @keyframes confetti-fall {
      0% {
        transform: translateY(-10vh) rotate(0deg);
        opacity: 1;
      }

      100% {
        transform: translateY(110vh) rotate(720deg);
        opacity: 0;
      }
    }

    /* Hi·ªáu ·ª©ng sao l·∫•p l√°nh */
    .star {
      position: fixed;
      font-size: 30px;
      animation: starTwinkle 2s ease-in-out infinite;
      pointer-events: none;
    }

    @keyframes starTwinkle {

      0%,
      100% {
        opacity: 0.3;
        transform: scale(0.5) rotate(0deg);
      }

      50% {
        opacity: 1;
        transform: scale(1) rotate(180deg);
      }
    }

    /* Hi·ªáu ·ª©ng con m√®o */
    .cat {
      position: fixed;
      font-size: 50px;
      animation: catWalk 8s linear infinite;
      z-index: 100;
    }

    @keyframes catWalk {
      0% {
        left: -100px;
        transform: scaleX(1);
      }

      48% {
        transform: scaleX(1);
      }

      50% {
        left: 50%;
        transform: scaleX(-1);
      }

      98% {
        transform: scaleX(-1);
      }

      100% {
        left: -100px;
        transform: scaleX(1);
      }
    }

    /* Hi·ªáu ·ª©ng con g·∫•u */
    .bear {
      position: fixed;
      font-size: 60px;
      animation: bearBounce 6s ease-in-out infinite;
      z-index: 100;
    }

    @keyframes bearBounce {

      0%,
      100% {
        bottom: -100px;
        left: 10%;
        transform: rotate(-10deg);
      }

      25% {
        bottom: 30%;
        left: 30%;
        transform: rotate(5deg);
      }

      50% {
        bottom: 50%;
        left: 50%;
        transform: rotate(0deg);
      }

      75% {
        bottom: 30%;
        left: 70%;
        transform: rotate(-5deg);
      }
    }

    /* Hi·ªáu ·ª©ng bong b√≥ng l∆° l·ª≠ng */
    .bubble {
      position: fixed;
      border-radius: 50%;
      background: radial-gradient(circle at 30% 30%, rgba(255, 255, 255, 0.8), rgba(255, 255, 255, 0.3) 60%, rgba(255, 255, 255, 0.1));
      box-shadow:
        inset 0 0 20px rgba(255, 255, 255, 0.5),
        0 0 20px rgba(255, 255, 255, 0.3);
      animation: bubbleFloat 6s ease-in-out infinite;
      pointer-events: none;
    }

    @keyframes bubbleFloat {
      0% {
        bottom: -100px;
        opacity: 0;
      }

      10% {
        opacity: 0.8;
      }

      90% {
        opacity: 0.8;
      }

      100% {
        bottom: 110vh;
        opacity: 0;
        transform: translateX(100px);
      }
    }

    /* Hi·ªáu ·ª©ng ph√°o hoa l·ªõn */
    .big-firework {
      position: fixed;
      width: 10px;
      height: 10px;
      border-radius: 50%;
      box-shadow: 0 0 20px currentColor;
    }

    @keyframes bigExplode {
      0% {
        transform: translate(0, 0) scale(1);
        opacity: 1;
      }

      100% {
        transform: translate(var(--tx), var(--ty)) scale(0);
        opacity: 0;
      }
    }

    /* Hi·ªáu ·ª©ng b√≥ng bay m·ªÅm m·∫°i */
    .balloon {
      position: fixed;
      bottom: -150px;
      width: 60px;
      height: 80px;
      border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%;
      animation: float-up 10s ease-in-out infinite;
      box-shadow:
        inset -10px -10px 20px rgba(0, 0, 0, 0.1),
        inset 10px 10px 20px rgba(255, 255, 255, 0.5),
        0 5px 15px rgba(0, 0, 0, 0.2);
      z-index: 50;
    }

    .balloon:before {
      content: "";
      position: absolute;
      bottom: -15px;
      left: 50%;
      width: 2px;
      height: 100px;
      background: linear-gradient(to bottom, rgba(150, 150, 150, 0.5), transparent);
      transform: translateX(-50%);
    }

    .balloon:after {
      content: "üéà";
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 45px;
      opacity: 0.9;
    }

    @keyframes float-up {
      0% {
        bottom: -150px;
        opacity: 0;
        transform: translateX(0) rotate(0deg);
      }

      10% {
        opacity: 1;
      }

      90% {
        opacity: 1;
      }

      50% {
        transform: translateX(40px) rotate(-8deg);
      }

      100% {
        bottom: 110vh;
        opacity: 0;
        transform: translateX(-20px) rotate(5deg);
      }
    }

    /* Emoji bay */
    .flying-emoji {
      position: fixed;
      font-size: 40px;
      animation: emojifly 8s ease-in-out infinite;
      z-index: 80;
    }

    @keyframes emojifly {
      0% {
        left: -100px;
        top: 20%;
        transform: rotate(0deg);
      }

      50% {
        left: 110%;
        top: 60%;
        transform: rotate(360deg);
      }

      100% {
        left: -100px;
        top: 20%;
        transform: rotate(720deg);
      }
    }

    /* Confetti (Gi·∫•y r∆°i) */
    .confetti {
      position: fixed;
      width: 10px;
      height: 10px;
      background: #ffd700;
      pointer-events: none;
      z-index: 70;
    }

    @keyframes confetti-fall {
      0% {
        transform: translateY(0) rotateZ(0deg) translateX(0);
        opacity: 1;
      }

      100% {
        transform: translateY(100vh) rotateZ(720deg) translateX(100px);
        opacity: 0;
      }
    }

    @keyframes confetti-fall-left {
      0% {
        transform: translateY(0) rotateZ(0deg) translateX(0);
        opacity: 1;
      }

      100% {
        transform: translateY(100vh) rotateZ(720deg) translateX(-100px);
        opacity: 0;
      }
    }

    /* B√≥ng bay n·ªï */
    .burst-bubble {
      position: fixed;
      border-radius: 50%;
      pointer-events: none;
      z-index: 60;
    }

    @keyframes bubble-burst {
      0% {
        transform: scale(1);
        opacity: 1;
      }

      100% {
        transform: scale(0);
        opacity: 0;
      }
    }

    /* Tia s√°ng */
    .sparkle {
      position: fixed;
      width: 4px;
      height: 4px;
      border-radius: 50%;
      pointer-events: none;
      z-index: 65;
    }

    @keyframes sparkle-shine {
      0% {
        opacity: 0;
        transform: scale(0);
      }

      50% {
        opacity: 1;
      }

      100% {
        opacity: 0;
        transform: scale(0);
      }
    }

    /* Hi·ªáu ·ª©ng flash s√°ng */
    @keyframes flash-burst {
      0% {
        box-shadow: 0 0 5px, 0 0 10px, 0 0 20px;
        opacity: 1;
      }

      100% {
        box-shadow: 0 0 50px, 0 0 100px, 0 0 150px;
        opacity: 0;
      }
    }

    /* Hi·ªáu ·ª©ng ph√°o hoa m·ªÅm m·∫°i */
    .firework {
      position: fixed;
      width: 6px;
      height: 6px;
      border-radius: 50%;
      box-shadow: 0 0 10px currentColor;
    }

    @keyframes explode {
      0% {
        transform: translate(0, 0) scale(1);
        opacity: 1;
      }

      100% {
        transform: translate(var(--tx), var(--ty)) scale(0);
        opacity: 0;
      }
    }

    .firework-container {
      position: fixed;
      pointer-events: none;
      z-index: 5;
    }

    /* =============================================
       RESPONSIVE - MOBILE & TABLET
       ============================================= */

    /* Tablet - M√†n h√¨nh nh·ªè h∆°n 768px */
    @media (max-width: 768px) {

      /* M√†n 0: Loading Screen */
      .code-container {
        width: 90%;
        padding: 15px;
      }

      .code-content {
        font-size: 12px;
        min-height: 150px;
      }

      .loading-title {
        font-size: 1.2em;
      }

      .success-icon {
        font-size: 80px;
      }

      .success-text {
        font-size: 1.5em;
      }

      /* M√†n 1: Thi·ªáp ch√∫c m·ª´ng */
      .card {
        padding: 40px 30px;
        max-width: 90%;
      }

      .card h1 {
        font-size: 2em;
      }

      .emoji {
        font-size: 3em;
      }

      .message {
        font-size: 1.1em;
      }

      .from-signature {
        font-size: 0.9em;
      }

      .btn-next {
        padding: 12px 30px;
        font-size: 1em;
      }

      /* M√†n 2: Th·ªïi n·∫øn */
      .cat-holder {
        width: 180px;
        height: 180px;
      }

      .cake {
        font-size: 120px;
      }

      .candles {
        top: -100px;
        gap: 40px;
      }

      .instruction {
        font-size: 1.3em;
        margin-top: 30px;
      }

      .mic-icon {
        font-size: 50px;
      }

      /* M√†n 3: L·ªùi ch√∫c */
      .wishes-container {
        max-width: 90%;
      }

      .wishes-title {
        font-size: 1.8em;
      }

      .wish-card {
        padding: 30px 40px;
      }

      .wish-icon {
        font-size: 1.8em;
      }

      .wish-text {
        font-size: 1em;
        line-height: 1.8;
      }

      .final-message {
        font-size: 1.5em;
        padding: 25px;
      }

      .gift-icon-inline {
        font-size: 60px;
      }

      .gift-title-inline {
        font-size: 1.5em;
      }

      .gift-btn-inline {
        padding: 12px 30px;
        font-size: 1.1em;
      }

      /* M√†n 4: Nh·∫≠n qu√† */
      .error-gif {
        width: 200px;
        height: 200px;
      }

      .error-code {
        font-size: 100px;
      }

      .error-message {
        font-size: 1.2em;
      }

      .form-title {
        font-size: 1.5em;
      }

      .wish-input {
        font-size: 0.95em;
        min-height: 120px;
      }
    }

    /* Mobile - M√†n h√¨nh nh·ªè h∆°n 480px */
    @media (max-width: 480px) {
      body {
        overflow-x: hidden;
      }

      /* M√†n 0: Loading Screen */
      .code-container {
        width: 95%;
        padding: 10px;
      }

      .code-content {
        font-size: 10px;
        min-height: 120px;
        line-height: 1.6;
      }

      .loading-bar-container {
        width: 90%;
      }

      .loading-title {
        font-size: 1em;
      }

      .loading-bar {
        height: 25px;
      }

      .success-icon {
        font-size: 60px;
      }

      .success-text {
        font-size: 1.2em;
      }

      /* M√†n 1: Thi·ªáp ch√∫c m·ª´ng */
      .card {
        padding: 30px 20px;
        max-width: 95%;
        border-radius: 20px;
      }

      .card h1 {
        font-size: 1.5em;
      }

      .emoji {
        font-size: 2.5em;
      }

      .message {
        font-size: 0.95em;
        line-height: 1.6;
      }

      .from-signature {
        font-size: 0.85em;
        margin-top: 20px;
      }

      .btn-next {
        padding: 10px 25px;
        font-size: 0.9em;
      }

      /* M√†n 2: Th·ªïi n·∫øn */
      .cat-holder {
        width: 120px;
        height: 120px;
      }

      .cake {
        font-size: 100px;
      }

      .candles {
        top: -80px;
        gap: 25px;
      }

      .candle {
        width: 70px;
      }

      .candle-flame-container {
        width: 70px;
        height: 90px;
      }

      .candle-smoke-container {
        width: 70px;
        height: 120px;
      }

      .candle-body {
        width: 35px;
        height: 70px;
      }

      .instruction {
        font-size: 1.1em;
        margin-top: 20px;
        padding: 0 15px;
      }

      .mic-icon {
        font-size: 40px;
      }

      .success-message {
        font-size: 1.5em;
      }

      /* M√†n 3: L·ªùi ch√∫c */
      .wishes-screen {
        padding: 20px 10px;
      }

      .wishes-container {
        max-width: 95%;
      }

      .wishes-title {
        font-size: 1.4em;
        margin-bottom: 20px;
      }

      .wish-card {
        padding: 25px 30px;
        margin: 15px 0;
      }

      .wish-card::after {
        font-size: 30px;
        top: 15px;
        right: 15px;
      }

      .wish-icon {
        font-size: 1.5em;
        margin-right: 10px;
      }

      .wish-text {
        font-size: 0.9em;
        line-height: 1.8;
      }

      .final-message {
        font-size: 1.2em;
        padding: 20px;
        margin-top: 30px;
      }

      .final-message span {
        font-size: 0.7em !important;
      }

      /* Gift question inline */
      .gift-question-inline {
        padding: 30px 20px;
        margin-top: 30px;
      }

      .gift-icon-inline {
        font-size: 50px;
      }

      .gift-title-inline {
        font-size: 1.2em;
      }

      .gift-buttons-inline {
        flex-direction: column;
        gap: 15px;
      }

      .gift-btn-inline {
        padding: 12px 30px;
        font-size: 1em;
        width: 100%;
      }

      /* M√†n 4: Nh·∫≠n qu√† */
      .gift-screen {
        padding: 20px 10px;
      }

      .error-gif {
        width: 150px;
        height: 150px;
      }

      .error-code {
        font-size: 80px;
      }

      .error-message {
        font-size: 1em;
        padding: 0 15px;
      }

      .error-emoji {
        font-size: 50px;
      }

      .countdown-text {
        font-size: 1.2em;
      }

      .countdown-number {
        font-size: 4em;
      }

      .form-icon {
        font-size: 50px;
      }

      .form-title {
        font-size: 1.2em;
        padding: 0 15px;
      }

      .wish-input {
        font-size: 0.9em;
        min-height: 100px;
        padding: 12px;
      }

      .submit-btn {
        padding: 12px 30px;
        font-size: 1em;
      }

      .success-title {
        font-size: 1.8em;
      }

      .success-text {
        font-size: 1em;
        padding: 0 15px;
      }

      /* Music Toggle */
      .music-toggle {
        width: 45px;
        height: 45px;
        font-size: 20px;
        bottom: 15px;
        right: 15px;
      }

      /* Airplane */
      .airplane {
        font-size: 60px;
      }

      /* Random images - Smaller on mobile */
      .random-image {
        max-width: 60px;
      }
    }

    /* Very small mobile - iPhone SE, etc */
    @media (max-width: 375px) {
      .card h1 {
        font-size: 1.3em;
      }

      .message {
        font-size: 0.85em;
      }

      .from-signature {
        font-size: 0.75em;
        margin-top: 15px;
      }

      .wishes-title {
        font-size: 1.2em;
      }

      .wish-card {
        padding: 20px 25px;
      }

      .wish-text {
        font-size: 0.85em;
      }

      .final-message {
        font-size: 1em;
      }

      .gift-title-inline {
        font-size: 1.1em;
      }

      .error-code {
        font-size: 60px;
      }

      .form-title {
        font-size: 1.1em;
      }
    }

    /* Landscape mode for mobile */
    @media (max-height: 500px) and (orientation: landscape) {
      .card {
        padding: 20px 30px;
        max-width: 80%;
      }

      .card h1 {
        font-size: 1.5em;
      }

      .emoji {
        font-size: 2em;
      }

      .message {
        font-size: 0.9em;
      }

      .cake-container {
        transform: scale(0.7);
      }

      .wishes-container {
        padding: 10px 0;
      }

      .wish-card {
        padding: 20px 30px;
        margin: 10px 0;
      }
    }
  </style>
</head>

<body>
  <!-- M√†n 0: Loading Screen -->
  <div class="loading-screen" id="loadingScreen">

    <!-- Code editor -->
    <div class="code-container" id="codeContainer">
      <div class="code-header">
        <div class="code-dot red"></div>
        <div class="code-dot yellow"></div>
        <div class="code-dot green"></div>
      </div>
      <div class="code-content" id="codeContent">
        <div class="code-cursor" id="codeCursor"></div>
      </div>
    </div>

    <!-- Lottie Cooking Animation Container -->
    <div style="display: none;" id="cookingContainer">
      <div class="loading-title">üéÇ ƒêang l√†m b√°nh sinh nh·∫≠t ...</div>
      <div id="cookingLottie" style="width: 320px; height: 320px; margin: 0 auto 24px auto;"></div>
    </div>

    <!-- Success message -->
    <div class="success-container" id="successContainer" style="display: none;">
      <div class="success-icon">‚úÖ</div>
      <div class="success-text">LOAD TH√ÄNH C√îNG!</div>
    </div>
  </div>

  <!-- M√†n 0.1: Go Screen -->
  <div class="go-screen" id="goScreen">
    <div class="go-container">
      <div class="go-emoji">üéâ</div>
      <div class="go-title">S·∫µn s√†ng ch∆∞a?</div>
      <button class="go-btn" id="goBtn">GO! üöÄ</button>
    </div>
  </div>

  <!-- Background Music -->
  <!--
    H∆Ø·ªöNG D·∫™N S·ª¨ D·ª§NG NH·∫†C LOCAL:
    1. T·∫£i file nh·∫°c Happy Birthday (MP3 format) v·ªÅ m√°y
    2. ƒê·ªïi t√™n file th√†nh: happy-birthday.mp3
    3. ƒê·∫∑t file nh·∫°c c√πng th∆∞ m·ª•c v·ªõi file birthday_card.html
    4. Ho·∫∑c thay ƒë·ªïi ƒë∆∞·ªùng d·∫´n src b√™n d∆∞·ªõi theo v·ªã tr√≠ file nh·∫°c c·ªßa b·∫°n

    V√≠ d·ª•:
    - C√πng th∆∞ m·ª•c: src="happy-birthday.mp3"
    - Trong th∆∞ m·ª•c music: src="music/happy-birthday.mp3"
    - ƒê∆∞·ªùng d·∫´n ƒë·∫ßy ƒë·ªß: src="D:/Music/happy-birthday.mp3"
  -->
  <audio id="bgMusic" loop autoplay>
    <source src="happy-birthday.mp3" type="audio/mpeg">
    <!-- Fallback n·∫øu kh√¥ng t√¨m th·∫•y file local, d√πng nh·∫°c online -->
    <source src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3" type="audio/mpeg">
  </audio>

  <!-- Music Toggle Button -->
  <button class="music-toggle" id="musicToggle" title="B·∫≠t/T·∫Øt nh·∫°c">üîä</button>

  <!-- M√†n h√¨nh 1: Thi·ªáp ch√∫c m·ª´ng -->
  <div class="card" id="greetingCard">
    <div class="emoji">üéÇ</div>
    <h1>Ch√∫c m·ª´ng sinh nh·∫≠t MIA!</h1>
    <div class="emoji">üéâ</div>
    <p class="message">
      Ch√∫c Mia tu·ªïi m·ªõi tr√†n ƒë·∫ßy ni·ªÅm vui,<br>
      h·∫°nh ph√∫c v√† th√†nh c√¥ng!<br>
      üéà Lu√¥n vui v·∫ª v√† t∆∞∆°i tr·∫ª! üéÅ
    </p>
    <p class="from-signature">
      ~ Thi·ªáp ƒë·∫øn t·ª´ Ed ~
    </p>
    <button class="btn-next" id="btnNext">üéÇ C√πng ∆∞·ªõc v√† th·ªïi n·∫øn n√†o! ‚ú®</button>
  </div>

  <!-- Hi·ªáu ·ª©ng m√°y bay -->
  <div class="airplane" id="airplane">‚úàÔ∏è</div>

  <!-- M√†n h√¨nh 2: Th·ªïi n·∫øn -->
  <div class="candle-screen" id="candleScreen">
    <div class="cake-container">
      <!-- Ch√∫ m√®o b√™ b√°nh - Lottie Animation -->
      <div class="cat-holder">
        <div id="catAnimation"></div>
      </div>

      <!-- B√°nh sinh nh·∫≠t v·ªõi n·∫øn -->
      <div style="position: relative;">
        <div class="candles">
          <div class="candle" id="candle1">
            <div class="flame-light"></div>
            <div class="flame"></div>
            <div class="wick-glow"></div>
            <div class="wick"></div>
            <div class="candle-body"></div>
            <div class="smoke"></div>
          </div>
          <div class="candle" id="candle2">
            <div class="flame-light"></div>
            <div class="flame"></div>
            <div class="wick-glow"></div>
            <div class="wick"></div>
            <div class="candle-body"></div>
            <div class="smoke"></div>
          </div>
          <div class="candle" id="candle3">
            <div class="flame-light"></div>
            <div class="flame"></div>
            <div class="wick-glow"></div>
            <div class="wick"></div>
            <div class="candle-body"></div>
            <div class="smoke"></div>
          </div>
        </div>
        <!-- B√°nh sinh nh·∫≠t b·∫±ng h√¨nh ·∫£nh -->
        <img src="cake.png" alt="Birthday Cake" class="cake-img-noeffect"
          style="width: 320px; max-width: 90vw; display: block; margin: -40px auto 0 auto; position: relative; z-index: 10; border-radius: 24px; animation: none; box-shadow: none; filter: none;" />
      </div>
    </div>
    <div class="instruction" id="instruction">
      üé§ H√£y th·ªïi v√†o mic ƒë·ªÉ t·∫Øt n·∫øn! üé§
    </div>
    <div class="mic-icon">üéôÔ∏è</div>
    <div class="success-message" id="successMessage">
      üéâ Ch√∫c m·ª´ng sinh nh·∫≠t! üéä
    </div>
  </div>

  <!-- M√†n h√¨nh 3: L·ªùi ch√∫c -->
  <div class="wishes-screen" id="wishesScreen">
    <div class="wishes-container">
      <div class="wishes-title">üíù My Wishes üíù</div>

      <div class="wish-card">
        <div class="wish-icon">üåü</div>
        <div class="wish-text">
          Ch√∫c Mia m·ªôt tu·ªïi m·ªõi tr√†n ƒë·∫ßy nƒÉng l∆∞·ª£ng v√† ni·ªÅm vui!<br>
          M·ªói ng√†y ƒë·ªÅu l√† m·ªôt m√≥n qu√† tuy·ªát v·ªùi!
        </div>
      </div>

      <div class="wish-card">
        <div class="wish-icon">üéØ</div>
        <div class="wish-text">
          Hy v·ªçng t·∫•t c·∫£ ∆∞·ªõc m∆° v√† m·ª•c ti√™u c·ªßa Mia ƒë·ªÅu s·ªõm tr·ªü th√†nh hi·ªán th·ª±c!
        </div>
      </div>

      <div class="wish-card">
        <div class="wish-icon">‚ù§Ô∏è</div>
        <div class="wish-text">
          Lu√¥n ƒë∆∞·ª£c bao quanh b·ªüi t√¨nh y√™u th∆∞∆°ng, h·∫°nh ph√∫c tr·ªçn v·∫πn, Lu√¥n c√≥ ng∆∞·ªùi ch·ªü che b·∫£o v·ªá ƒë·ªÉ Mia kh√¥ng bao gi·ªù ph·∫£i ƒë·ªëi m·∫∑t kh√≥ khƒÉn m·ªôt m√¨nh! üíï!
        </div>
      </div>

      <div class="wish-card">
        <div class="wish-icon">ü•õ</div>
        <div class="wish-text">
          Nh·ªõ u·ªëng nhi·ªÅu s·ªØa m·ªói ng√†y ƒë·ªÉ c√≥ h√†m rƒÉng kh·ªèe trong khi ch·ªânh nha!‚ú®
        </div>
      </div>

      <div class="wish-card">
        <div class="wish-icon">üöÄ</div>
        <div class="wish-text">
          Con ƒë∆∞·ªùng ph√≠a tr∆∞·ªõc c·ªßa Mia s·∫Ω tr√†n ƒë·∫ßy c∆° h·ªôi v√† may m·∫Øn, ti·∫øn b∆∞·ªõc t·ª± tin v√† v·ªØng ch·∫Øc nh√©!
        </div>
      </div>

      <div class="final-message">
        üéÇ‚ú® HAPPY BIRTHDAY MIA ‚ú®üéÇ<br>
        <span style="font-size: 0.6em; margin-top: 10px; display: block;">
          Ch√∫c Mia c√≥ m·ªôt ng√†y sinh nh·∫≠t ƒë·∫ßy b·∫•t ng·ªù v√† h·∫°nh ph√∫c! üéâüíù
        </span>
        <div class="ed-signature">
          <span style="font-size: 0.5em; margin-top: 20px; display: block; font-style: italic; color: #A0522D;">
            ‚ú® G·ª≠i t·ª´ anh n√†o ƒë√≥ hay b·∫Øt n·∫°t‚ú®
          </span>
        </div>
      </div>

      <!-- C√¢u h·ªèi nh·∫≠n qu√† - ƒê·∫∑t ·ªü cu·ªëi l·ªùi ch√∫c -->
      <!-- <div class="gift-question-inline" id="giftQuestion">
        <div class="gift-icon-inline">üéÅ</div>
        <div class="gift-title-inline">B·∫°n c√≥ mu·ªën nh·∫≠n qu√† kh√¥ng?</div>
        <div class="gift-buttons-inline">
          <button class="gift-btn-inline yes" id="btnYes">C√≥! üòç</button>
          <button class="gift-btn-inline no" id="btnNo">Kh√¥ng üò¢</button>
        </div>
      </div> -->
    </div>
  </div>

  <!-- M√†n h√¨nh 4: Nh·∫≠n qu√† (404, countdown, form) -->
  <div class="gift-screen" id="giftScreen">

    <!-- L·ªói 404 (ƒë√πa) -->
    <div class="error-404" id="error404">
      <!-- Lottie animation m√®o -->
      <div class="error-gif" id="catOutAnimation"></div>
      <div class="error-code">404</div>
      <div class="error-message">Oops! Qu√† kh√¥ng t√¨m th·∫•y! ü§≠</div>
      <div class="error-emoji">üòÖ</div>
      <div class="error-message" style="font-size: 1.5em;">
        ƒê√πa th√¥i! Ch·ªù t√≠ nh√©... üòä
      </div>
    </div>

    <!-- ƒê·∫øm ng∆∞·ª£c -->
    <div class="countdown-container" id="countdownContainer">
      <div class="countdown-text">Qu√† th·∫≠t c·ªßa b·∫°n s·∫Ω xu·∫•t hi·ªán sau...</div>
      <div class="countdown-number" id="countdownNumber">3</div>
    </div>

    <!-- Form nh·∫≠p ƒëi·ªÅu ∆∞·ªõc -->
    <div class="wish-form-container" id="wishFormContainer">
      <div class="form-icon">üéÅ</div>
      <div class="form-title">Qu√† c·ªßa b·∫°n l√† 1 ƒëi·ªÅu ∆∞·ªõc<br>Nh·∫≠p ƒëi·ªÅu ∆∞·ªõc üåü</div>
      <textarea class="wish-input" id="wishInput" placeholder="Nh·∫≠p ƒëi·ªÅu ∆∞·ªõc c·ªßa b·∫°n v√†o ƒë√¢y... ‚ú®"
        maxlength="500"></textarea>
      <button class="submit-btn" id="submitBtn">G·ª≠i ƒëi·ªÅu ∆∞·ªõc ƒëi üöÄ</button>
    </div>

    <!-- Th√¥ng b√°o th√†nh c√¥ng -->
    <div class="submit-success" id="submitSuccess">
      <div class="success-icon">üéä</div>
      <div class="success-title">ƒê√£ g·ª≠i th√†nh c√¥ng! ‚ú®</div>
      <div class="success-text">
        ƒêi·ªÅu ∆∞·ªõc c·ªßa Mia ƒë√£ ƒë∆∞·ª£c g·ª≠i ƒëi!<br>
        Ch√∫c Mia s·ªõm ƒë·∫°t ƒë∆∞·ª£c ƒëi·ªÅu m√¨nh mong mu·ªën! üåü
      </div>
    </div>
  </div>

  <script>
    // =============================================
    // M√ÄNG 0: LOADING SCREEN
    // =============================================

    const codeLines = [
      '<span class="keyword">const</span> <span class="const">birthdayCard</span> = {',
      '  <span class="function">init</span>: <span class="keyword">function</span>() {',
      '    <span class="comment">// Kh·ªüi t·∫°o thi·ªáp sinh nh·∫≠t</span>',
      '    <span class="keyword">this</span>.<span class="function">createCake</span>();',
      '    <span class="keyword">this</span>.<span class="function">lightCandles</span>();',
      '    <span class="keyword">this</span>.<span class="function">addFireworks</span>();',
      '  },',
      '  <span class="function">createCake</span>: <span class="keyword">function</span>() {',
      '    <span class="keyword">const</span> <span class="const">layers</span> = <span class="number">3</span>;',
      '    <span class="keyword">return</span> <span class="string">"üéÇ"</span>;',
      '  },',
      '  <span class="function">lightCandles</span>: <span class="keyword">function</span>() {',
      '    <span class="keyword">const</span> <span class="const">candles</span> = [<span class="string">"üïØÔ∏è"</span>, <span class="string">"üïØÔ∏è"</span>, <span class="string">"üïØÔ∏è"</span>];',
      '    <span class="keyword">return</span> candles.<span class="function">map</span>(c => c + <span class="string">"üî•"</span>);',
      '  },',
      '  <span class="function">addFireworks</span>: <span class="keyword">function</span>() {',
      '    <span class="comment">// T·∫°o ph√°o hoa tuy·ªát ƒë·∫πp</span>',
      '    <span class="keyword">return</span> <span class="string">"üéÜ‚ú®üéá"</span>;',
      '  }',
      '};',
      '',
      '<span class="comment">// B·∫Øt ƒë·∫ßu t·∫°o thi·ªáp sinh nh·∫≠t</span>',
      'birthdayCard.<span class="function">init</span>();',
      '<span class="keyword">console</span>.<span class="function">log</span>(<span class="string">"üéâ Happy Birthday! üéâ"</span>);'
    ];

    let currentLine = 0;
    const codeContent = document.getElementById('codeContent');
    const codeCursor = document.getElementById('codeCursor');
    const codeContainer = document.getElementById('codeContainer');
    const cookingLottie = document.getElementById('cookingLottie');
    const cookingContainer = document.getElementById('cookingContainer');
    const successContainer = document.getElementById('successContainer');
    const loadingScreen = document.getElementById('loadingScreen');

    // G√µ code t·ª´ng d√≤ng
    function typeCode() {
      if (currentLine < codeLines.length) {
        const lineDiv = document.createElement('div');
        lineDiv.className = 'code-line';
        lineDiv.innerHTML = codeLines[currentLine];
        lineDiv.style.animationDelay = '0s';

        codeContent.insertBefore(lineDiv, codeCursor);
        currentLine++;

        setTimeout(typeCode, 80); // T·ªëc ƒë·ªô g√µ nhanh h∆°n: 80ms/d√≤ng (t·ªëi ∆∞u t·ª´ 100ms)
      } else {
        // Ho√†n th√†nh g√µ code, b·∫Øt ƒë·∫ßu loading
        setTimeout(() => {
          codeCursor.style.display = 'none';
          codeContainer.style.animation = 'fadeOut 0.5s ease-out forwards';

          setTimeout(() => {
            codeContainer.style.display = 'none';
            cookingContainer.style.display = 'block';
            startCookingAnimation();
          }, 500);
        }, 500);
      }
    }

    // Load v√† ch·∫°y Lottie Cooking animation
    function startCookingAnimation() {
      console.log('Starting cooking animation...');
      
      // ƒê·∫£m b·∫£o Lottie ƒë√£ ƒë∆∞·ª£c load
      if (typeof lottie === 'undefined') {
        console.error('‚ùå Lottie library not loaded!');
        return;
      }

      try {
        console.log('Attempting to load Cooking.json with path...');
        const anim = lottie.loadAnimation({
          container: cookingLottie,
          renderer: 'svg',
          loop: false,
          autoplay: true,
          path: 'Cooking.json'
        });

        console.log('‚úÖ Animation created:', anim);

        // D·ª´ng animation sau 10 gi√¢y
        setTimeout(() => {
          console.log('‚úÖ 10 seconds passed, stopping animation...');
          anim.pause();
          
          setTimeout(() => {
            cookingContainer.style.display = 'none';
            successContainer.style.display = 'block';
            
            setTimeout(() => {
              loadingScreen.style.display = 'none';
              const goScreen = document.getElementById('goScreen');
              if (goScreen) {
                goScreen.style.display = 'flex';
              }
            }, 800);
          }, 300);
        }, 15000); // 10 gi√¢y

        // Fallback: n·∫øu c√≥ l·ªói g√¨ x·∫£y ra
        anim.addEventListener('complete', () => {
          console.log('‚úÖ Cooking animation completed!');
          if (cookingContainer.style.display !== 'none') {
            setTimeout(() => {
              cookingContainer.style.display = 'none';
              successContainer.style.display = 'block';
              
              setTimeout(() => {
                loadingScreen.style.display = 'none';
                const goScreen = document.getElementById('goScreen');
                if (goScreen) {
                  goScreen.style.display = 'flex';
                }
              }, 800);
            }, 300);
          }
        });

      } catch (error) {
        console.error('‚ùå Error loading Cooking.json:', error);
        cookingContainer.style.display = 'none';
        successContainer.style.display = 'block';
        setTimeout(() => {
          loadingScreen.style.display = 'none';
          const goScreen = document.getElementById('goScreen');
          if (goScreen) {
            goScreen.style.display = 'flex';
          }
        }, 800);
      }
    }

    // B·∫Øt ƒë·∫ßu loading screen - T·ªëi ∆∞u h√≥a
    setTimeout(typeCode, 300); // B·∫Øt ƒë·∫ßu nhanh h∆°n: 300ms (t·ªëi ∆∞u t·ª´ 500ms)

    // ·∫®n m√†n 1 ban ƒë·∫ßu
    window.addEventListener('DOMContentLoaded', () => {
      const greetingCard = document.getElementById('greetingCard');
      if (greetingCard) {
        greetingCard.style.display = 'none';
      }
    });

    // =============================================
    // C√ÄI ƒê·∫∂T C≈® B√äN D∆Ø·ªöI
    // =============================================

    // C·∫§U H√åNH FORMSPREE - C·ª∞C K·ª≤ ƒê·ª†N GI·∫¢N!
    // =============================================
    // B∆∞·ªõc 1: Truy c·∫≠p https://formspree.io/ v√† ƒëƒÉng k√Ω (MI·ªÑN PH√ç)
    // B∆∞·ªõc 2: T·∫°o form m·ªõi v√† l·∫•y Form Endpoint URL
    // B∆∞·ªõc 3: D√°n URL v√†o bi·∫øn FORMSPREE_ENDPOINT b√™n d∆∞·ªõi
    // Xong! Kh√¥ng c·∫ßn c·∫•u h√¨nh g√¨ th√™m! üéâ

    const FORMSPREE_ENDPOINT = 'https://formspree.io/f/xbdjnnez';
    // V√≠ d·ª•: 'https://formspree.io/f/xpwzbkqr'

    // =============================================

    // M√†u pastel m·ªÅm m·∫°i
    const colors = ['#FFB6C1', '#FFD4E5', '#E0BBE4', '#A8DADC', '#B4E7CE', '#FFF4A3', '#FFE5D9', '#D4A5A5'];

    // X·ª≠ l√Ω nh·∫°c n·ªÅn
    const bgMusic = document.getElementById('bgMusic');
    const musicToggle = document.getElementById('musicToggle');
    let isMusicPlaying = false;

    // Set volume
    bgMusic.volume = 0.5;

    // H√†m kh·ªüi ƒë·ªông nh·∫°c
    function startMusic() {
      bgMusic.play().then(() => {
        isMusicPlaying = true;
        musicToggle.textContent = 'üîä';
        musicToggle.style.animation = 'musicPulse 2s ease-in-out infinite';
        // Remove all event listeners after successful play
        document.removeEventListener('click', startMusic);
        document.removeEventListener('keydown', startMusic);
        document.removeEventListener('touchstart', startMusic);
      }).catch(err => {
        console.log('Autoplay prevented:', err);
      });
    }

    // Th·ª≠ ph√°t nh·∫°c ngay l·∫≠p t·ª©c
    startMusic();

    // Th√™m listeners cho c√°c t∆∞∆°ng t√°c ƒë·∫ßu ti√™n n·∫øu autoplay b·ªã ch·∫∑n
    document.addEventListener('click', startMusic, { once: true });
    document.addEventListener('keydown', startMusic, { once: true });
    document.addEventListener('touchstart', startMusic, { once: true });

    // Toggle nh·∫°c khi click n√∫t
    musicToggle.addEventListener('click', (e) => {
      e.stopPropagation();
      if (isMusicPlaying) {
        bgMusic.pause();
        musicToggle.textContent = 'üîá';
        isMusicPlaying = false;
      } else {
        bgMusic.play().then(() => {
          musicToggle.textContent = 'üîä';
          isMusicPlaying = true;
          musicToggle.style.animation = 'musicPulse 2s ease-in-out infinite';
        });
      }
    });

    // X·ª∞ L√ù N√öT GO
    // =============================================
    const goBtn = document.getElementById('goBtn');
    const goScreenElement = document.getElementById('goScreen');

    goBtn.addEventListener('click', () => {
      // Ph√°t nh·∫°c
      bgMusic.play().then(() => {
        isMusicPlaying = true;
        musicToggle.textContent = 'üîä';
        musicToggle.style.animation = 'musicPulse 2s ease-in-out infinite';
      }).catch(err => {
        console.log('Cannot play music:', err);
      });

      // ·∫®n m√†n Go v·ªõi animation
      goScreenElement.classList.add('hidden');

      setTimeout(() => {
        goScreenElement.style.display = 'none';
        // Hi·ªÉn th·ªã m√†n 1 (greeting card)
        if (greetingCard) {
          greetingCard.style.display = 'flex';

          // ===== HI·ªÜU ·ª®NG NG·∫™U NHI√äN H∆†N ·ªû M√ÄN 1 =====
          // Confetti: random s·ªë l·∫ßn, random delay
          const confettiTimes = 2 + Math.floor(Math.random() * 3); // 2-4 l·∫ßn
          for (let i = 0; i < confettiTimes; i++) {
            setTimeout(() => createConfetti(40 + Math.floor(Math.random() * 60)), 200 + Math.random() * 1200);
          }

          // Firework: random s·ªë l·∫ßn, random delay, random interval
          let fireworkCount = 6 + Math.floor(Math.random() * 5); // 6-10 l·∫ßn
          let fireworkIntervals = [];
          for (let i = 0; i < fireworkCount; i++) {
            fireworkIntervals.push(setTimeout(() => randomFirework(), 500 + Math.random() * 7000));
          }

          // ƒê√£ b·ªè hi·ªáu ·ª©ng emoji bay ·ªü m√†n 1

          // Celebration spray: random v·ªã tr√≠, random delay, random s·ªë l·∫ßn
          const sprayCount = 2 + Math.floor(Math.random() * 3); // 2-4 l·∫ßn
          for (let i = 0; i < sprayCount; i++) {
            setTimeout(() => {
              const x = Math.random() * window.innerWidth * 0.8 + window.innerWidth * 0.1;
              const y = Math.random() * window.innerHeight * 0.4 + window.innerHeight * 0.05;
              createCelebrationSpray(x, y);
            }, 400 + Math.random() * 1800);
          }
        }
      }, 1000);
    });

    // X·ª≠ l√Ω chuy·ªÉn m√†n h√¨nh
    const btnNext = document.getElementById('btnNext');
    const greetingCard = document.getElementById('greetingCard');
    const airplane = document.getElementById('airplane');
    const candleScreen = document.getElementById('candleScreen');

    btnNext.addEventListener('click', () => {

      // Hi·ªÉn th·ªã m√°y bay bay qua
      airplane.style.display = 'block';

      // Sau 1.5 gi√¢y ·∫©n m√†n h√¨nh 1
      setTimeout(() => {
        greetingCard.style.animation = 'fadeOut 0.5s ease-out forwards';
      }, 1500);

      // Sau 2 gi√¢y hi·ªÉn th·ªã m√†n h√¨nh 2 v√† t·∫°m d·ª´ng nh·∫°c
      setTimeout(() => {
        greetingCard.style.display = 'none';
        candleScreen.style.display = 'flex';

        // T·∫°m d·ª´ng nh·∫°c khi v√†o m√†n th·ªïi n·∫øn
        bgMusic.pause();
        isMusicPlaying = false;
        musicToggle.textContent = 'üîá';

        // Load Lottie animation cho m√®o
        loadCatAnimation();

        startMicrophoneDetection();
      }, 2000);
    });

    // Load Lottie animation
    function loadCatAnimation() {
      const container = document.getElementById('catAnimation');

      // X√≥a animation c≈© n·∫øu c√≥
      if (container._lottie) {
        container._lottie.destroy();
      }

      // Load animation m·ªõi
      try {
        container._lottie = lottie.loadAnimation({
          container: container,
          renderer: 'svg',
          loop: true,
          autoplay: true,
          path: 'cat_show.json' // File JSON ·ªü c√πng th∆∞ m·ª•c v·ªõi HTML
        });

        console.log('‚úÖ Lottie animation loaded successfully!');
      } catch (error) {
        console.error('‚ùå Error loading Lottie animation:', error);
        // Fallback: Hi·ªÉn th·ªã emoji n·∫øu load l·ªói
        container.innerHTML = '<div style="font-size: 150px;">üò∫</div>';
      }
    }

    // Load Lottie animation cho m√®o 404
    function loadCatOutAnimation() {
      const container = document.getElementById('catOutAnimation');

      // X√≥a animation c≈© n·∫øu c√≥
      if (container._lottie) {
        container._lottie.destroy();
      }

      // Load animation m·ªõi
      try {
        container._lottie = lottie.loadAnimation({
          container: container,
          renderer: 'svg',
          loop: true,
          autoplay: true,
          path: 'cat_out.json' // File JSON cho m√®o 404
        });

        console.log('‚úÖ Cat out animation loaded successfully!');
      } catch (error) {
        console.error('‚ùå Error loading cat out animation:', error);
        // Fallback: Hi·ªÉn th·ªã emoji n·∫øu load l·ªói
        container.innerHTML = '<div style="font-size: 150px;">üê±</div>';
      }
    }

    // CSS cho fadeOut
    const style = document.createElement('style');
    style.textContent = `
      @keyframes fadeOut {
        from {
          opacity: 1;
          transform: scale(1);
        }
        to {
          opacity: 0;
          transform: scale(0.8);
        }
      }
    `;
    document.head.appendChild(style);

    // Ph√°t hi·ªán √¢m thanh t·ª´ microphone
    let audioContext;
    let analyser;
    let microphone;
    let dataArray;
    let candles = [
      document.getElementById('candle1'),
      document.getElementById('candle2'),
      document.getElementById('candle3')
    ];
    let blownCandles = 0;

    function startMicrophoneDetection() {
      navigator.mediaDevices.getUserMedia({ audio: true })
        .then(stream => {
          audioContext = new (window.AudioContext || window.webkitAudioContext)();
          analyser = audioContext.createAnalyser();
          microphone = audioContext.createMediaStreamSource(stream);
          analyser.fftSize = 256;

          const bufferLength = analyser.frequencyBinCount;
          dataArray = new Uint8Array(bufferLength);

          microphone.connect(analyser);
          detectBlow();
        })
        .catch(err => {
          console.log('Microphone access denied:', err);
          document.getElementById('instruction').textContent = 'üñ±Ô∏è Click v√†o n·∫øn ƒë·ªÉ t·∫Øt! üñ±Ô∏è';
          // Th√™m ch·ª©c nƒÉng click n·∫øu kh√¥ng c√≥ mic
          candles.forEach(candle => {
            candle.style.cursor = 'pointer';
            candle.addEventListener('click', () => blowCandle(candle));
          });
        });
    }

    function detectBlow() {
      analyser.getByteFrequencyData(dataArray);

      // T√≠nh gi√° tr·ªã trung b√¨nh c·ªßa √¢m thanh
      let sum = 0;
      for (let i = 0; i < dataArray.length; i++) {
        sum += dataArray[i];
      }
      let average = sum / dataArray.length;

      // N·∫øu √¢m thanh ƒë·ªß m·∫°nh (th·ªïi), t·∫Øt n·∫øn
      if (average > 50 && blownCandles < 3) {
        blowCandle(candles[blownCandles]);
      }

      if (blownCandles < 3) {
        requestAnimationFrame(detectBlow);
      }
    }

    function blowCandle(candle) {
      if (!candle.classList.contains('blown')) {
        // Th√™m hi·ªáu ·ª©ng th·ªïi
        const blowEffect = document.createElement('div');
        blowEffect.style.cssText = `
          position: fixed;
          left: 50%;
          top: 50%;
          transform: translate(-50%, -50%);
          width: 200px;
          height: 200px;
          background: radial-gradient(circle, rgba(255,255,255,0.6), transparent);
          border-radius: 50%;
          pointer-events: none;
          z-index: 1000;
          animation: blowWind 0.6s ease-out forwards;
        `;
        document.body.appendChild(blowEffect);
        setTimeout(() => blowEffect.remove(), 600);

        // Th√™m animation blowWind n·∫øu ch∆∞a c√≥
        if (!document.getElementById('blowWindStyle')) {
          const style = document.createElement('style');
          style.id = 'blowWindStyle';
          style.textContent = `
            @keyframes blowWind {
              0% {
                transform: translate(-50%, -50%) scale(0);
                opacity: 0.8;
              }
              100% {
                transform: translate(-50%, -50%) scale(3);
                opacity: 0;
              }
            }
          `;
          document.head.appendChild(style);
        }

        // T·∫°o tia l·ª≠a bay ra khi th·ªïi t·∫Øt
        const rect = candle.getBoundingClientRect();
        const centerX = rect.left + rect.width / 2;
        const centerY = rect.top - 50;

        for (let i = 0; i < 8; i++) {
          const spark = document.createElement('div');
          spark.style.cssText = `
            position: fixed;
            left: ${centerX}px;
            top: ${centerY}px;
            width: 4px;
            height: 4px;
            background: #ff6b00;
            border-radius: 50%;
            pointer-events: none;
            z-index: 1000;
            box-shadow: 0 0 8px #ff6b00;
          `;
          document.body.appendChild(spark);

          const angle = (Math.PI * 2 * i) / 8;
          const distance = 30 + Math.random() * 20;
          const tx = Math.cos(angle) * distance;
          const ty = Math.sin(angle) * distance;

          spark.animate([
            { transform: 'translate(0, 0) scale(1)', opacity: 1 },
            { transform: `translate(${tx}px, ${ty}px) scale(0)`, opacity: 0 }
          ], {
            duration: 400 + Math.random() * 200,
            easing: 'ease-out'
          }).onfinish = () => spark.remove();
        }

        candle.classList.add('blown');
        blownCandles++;

        // T·∫°o ph√°o hoa khi t·∫Øt n·∫øn
        createFirework(centerX, centerY);

        if (blownCandles === 3) {
          // T·∫°o nhi·ªÅu ph√°o hoa khi t·∫Øt h·∫øt n·∫øn
          for (let i = 0; i < 10; i++) {
            setTimeout(() => {
              randomFirework();
            }, i * 200);
          }

          // Chuy·ªÉn ngay sang m√†n l·ªùi ch√∫c sau 1 gi√¢y
          setTimeout(() => {
            transitionToWishesScreen();
          }, 1000);
        }
      }
    }

    // Chuy·ªÉn sang m√†n h√¨nh l·ªùi ch√∫c
    function transitionToWishesScreen() {
      const candleScreen = document.getElementById('candleScreen');
      const wishesScreen = document.getElementById('wishesScreen');

      // Fade out m√†n 2
      candleScreen.style.animation = 'fadeOut 1s ease-out forwards';

      setTimeout(() => {
        candleScreen.style.display = 'none';
        wishesScreen.style.display = 'flex';

        // Ph√°t l·∫°i nh·∫°c khi chuy·ªÉn sang m√†n l·ªùi ch√∫c
        bgMusic.play().then(() => {
          isMusicPlaying = true;
          musicToggle.textContent = 'üîä';
          musicToggle.style.animation = 'musicPulse 2s ease-in-out infinite';
        }).catch(err => {
          console.log('Cannot resume music:', err);
        });

        // T·∫°o hi·ªáu ·ª©ng tr√°i tim bay l√™n
        const heartsInterval = createFloatingHearts();

        // T·∫°o ph√°o hoa li√™n t·ª•c
        const fireworkInterval = setInterval(() => {
          randomFirework();
        }, 800);

        // D·ª´ng ph√°o hoa sau 10 gi√¢y
        setTimeout(() => {
          clearInterval(fireworkInterval);
        }, 10000);

        // Kh√¥ng t·ª± ƒë·ªông chuy·ªÉn m√†n n·ªØa - ng∆∞·ªùi d√πng s·∫Ω click n√∫t nh·∫≠n qu√†
      }, 1000);
    }

    // T·∫°o hi·ªáu ·ª©ng tr√°i tim bay l√™n
    function createFloatingHearts() {
      const hearts = ['‚ù§Ô∏è', 'üíï', 'üíñ', 'üíó', 'üíù', 'üíû'];

      const interval = setInterval(() => {
        const heart = document.createElement('div');
        heart.className = 'heart';
        heart.textContent = hearts[Math.floor(Math.random() * hearts.length)];
        heart.style.left = Math.random() * 100 + 'vw';
        heart.style.bottom = '-50px';
        heart.style.animationDuration = (Math.random() * 2 + 3) + 's';
        heart.style.animationDelay = Math.random() * 0.5 + 's';
        document.body.appendChild(heart);

        setTimeout(() => heart.remove(), 5000);
      }, 500);

      return interval;
    }

    // Chuy·ªÉn sang m√†n h√¨nh nh·∫≠n qu√†
    function transitionToGiftScreen() {
      const wishesScreen = document.getElementById('wishesScreen');
      const giftScreen = document.getElementById('giftScreen');

      // Fade out m√†n 3
      wishesScreen.style.animation = 'fadeOut 1s ease-out forwards';

      setTimeout(() => {
        wishesScreen.style.display = 'none';
        giftScreen.style.display = 'flex';
      }, 1000);
    }

    // X·ª≠ l√Ω m√†n h√¨nh nh·∫≠n qu√†
    const btnYes = document.getElementById('btnYes');
    const btnNo = document.getElementById('btnNo');
    const giftQuestion = document.getElementById('giftQuestion');
    const error404 = document.getElementById('error404');
    const countdownContainer = document.getElementById('countdownContainer');
    const wishFormContainer = document.getElementById('wishFormContainer');
    const submitSuccess = document.getElementById('submitSuccess');
    const wishesScreen = document.getElementById('wishesScreen');
    const giftScreen = document.getElementById('giftScreen');

    // B·∫•m n√∫t "C√≥"
    btnYes.addEventListener('click', () => {
      // ·∫®n c√¢u h·ªèi trong m√†n l·ªùi ch√∫c
      giftQuestion.classList.add('hidden');

      // Chuy·ªÉn sang m√†n gift screen ƒë·ªÉ hi·ªÉn th·ªã 404
      wishesScreen.style.animation = 'fadeOut 0.5s ease-out forwards';

      setTimeout(() => {
        wishesScreen.style.display = 'none';
        giftScreen.style.display = 'flex';

        // Hi·ªÉn th·ªã l·ªói 404
        error404.style.display = 'block';

        // Load Lottie animation cho m√®o 404
        loadCatOutAnimation();

        // T·∫°o ph√°o hoa ng·∫´u nhi√™n ƒë·ªÉ tƒÉng hi·ªáu ·ª©ng
        for (let i = 0; i < 5; i++) {
          setTimeout(() => randomFirework(), i * 300);
        }

        // Sau 3 gi√¢y, hi·ªÉn th·ªã ƒë·∫øm ng∆∞·ª£c
        setTimeout(() => {
          error404.style.animation = 'fadeOut 0.5s ease-out forwards';

          setTimeout(() => {
            error404.style.display = 'none';
            countdownContainer.style.display = 'block';
            startCountdown();
          }, 500);
        }, 3000);
      }, 500);
    });

    // B·∫•m n√∫t "Kh√¥ng"
    btnNo.addEventListener('click', () => {
      // Hi·ªÉn th·ªã th√¥ng b√°o vui
      alert('Kh√¥ng sao! B·∫°n v·∫´n l√† ng∆∞·ªùi ƒë·∫∑c bi·ªát! üéâüíù');

      // ·∫®n c√¢u h·ªèi
      giftQuestion.classList.add('hidden');

      // V·∫´n chuy·ªÉn sang m√†n gift screen
      wishesScreen.style.animation = 'fadeOut 0.5s ease-out forwards';

      setTimeout(() => {
        wishesScreen.style.display = 'none';
        giftScreen.style.display = 'flex';
        error404.style.display = 'block';

        // Load Lottie animation cho m√®o 404
        loadCatOutAnimation();

        setTimeout(() => {
          error404.style.animation = 'fadeOut 0.5s ease-out forwards';

          setTimeout(() => {
            error404.style.display = 'none';
            countdownContainer.style.display = 'block';
            startCountdown();
          }, 500);
        }, 3000);
      }, 500);
    });

    // ƒê·∫øm ng∆∞·ª£c t·ª´ 3
    function startCountdown() {
      let count = 3;
      const countdownNumber = document.getElementById('countdownNumber');

      const countInterval = setInterval(() => {
        count--;

        if (count > 0) {
          countdownNumber.textContent = count;
          countdownNumber.style.animation = 'none';
          setTimeout(() => {
            countdownNumber.style.animation = 'countPulse 1s ease-in-out';
          }, 10);

          // Ph√°o hoa m·ªói gi√¢y
          randomFirework();
        } else {
          clearInterval(countInterval);

          // Hi·ªÉn th·ªã form
          countdownContainer.style.animation = 'fadeOut 0.5s ease-out forwards';

          setTimeout(() => {
            countdownContainer.style.display = 'none';
            wishFormContainer.style.display = 'block';

            // T·∫°o nhi·ªÅu ph√°o hoa khi hi·ªÉn th·ªã form
            for (let i = 0; i < 10; i++) {
              setTimeout(() => randomFirework(), i * 200);
            }
          }, 500);
        }
      }, 1000);
    }

    // X·ª≠ l√Ω submit form
    const submitBtn = document.getElementById('submitBtn');
    const wishInput = document.getElementById('wishInput');

    submitBtn.addEventListener('click', () => {
      const wish = wishInput.value.trim();

      if (wish === '') {
        alert('H√£y vi·∫øt ƒëi·ªÅu ∆∞·ªõc c·ªßa b·∫°n tr∆∞·ªõc khi g·ª≠i! üåü');
        wishInput.focus();
        return;
      }

      // Hi·ªÉn th·ªã loading effect
      submitBtn.textContent = 'ƒêang g·ª≠i... ‚ú®';
      submitBtn.disabled = true;

      // G·ª≠i email qua Formspree
      if (FORMSPREE_ENDPOINT !== 'https://formspree.io/f/YOUR_FORM_ID') {
        sendEmailWithFormspree(wish);
      } else {
        // N·∫øu ch∆∞a c·∫•u h√¨nh Formspree, v·∫´n hi·ªÉn th·ªã th√†nh c√¥ng (demo mode)
        console.warn('‚ö†Ô∏è Formspree ch∆∞a ƒë∆∞·ª£c c·∫•u h√¨nh. Vui l√≤ng xem h∆∞·ªõng d·∫´n trong code.');
        console.log('‚ú® ƒêi·ªÅu ∆∞·ªõc:', wish);
        showSuccessMessage();
      }
    });

    // H√†m g·ª≠i email qua Formspree
    function sendEmailWithFormspree(wish) {
      const formData = {
        wish: wish,
        date: new Date().toLocaleString('vi-VN'),
        _subject: `üéÇ ƒêi·ªÅu ∆∞·ªõc sinh nh·∫≠t m·ªõi`,
        _replyto: 'noreply@birthday.com'
      };

      fetch(FORMSPREE_ENDPOINT, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify(formData)
      })
        .then(response => {
          if (response.ok) {
            console.log('‚úÖ Email ƒë√£ g·ª≠i th√†nh c√¥ng qua Formspree!');
            showSuccessMessage();
          } else {
            throw new Error('Network response was not ok');
          }
        })
        .catch(error => {
          console.error('‚ùå L·ªói khi g·ª≠i email:', error);
          submitBtn.textContent = 'G·ª≠i ƒëi·ªÅu ∆∞·ªõc ƒëi üöÄ';
          submitBtn.disabled = false;
          alert('C√≥ l·ªói x·∫£y ra khi g·ª≠i email. Vui l√≤ng th·ª≠ l·∫°i! üòî\n\nL·ªói: ' + error.message);
        });
    }

    // H√†m hi·ªÉn th·ªã th√†nh c√¥ng
    function showSuccessMessage() {
      setTimeout(() => {
        // ·∫®n form
        wishFormContainer.style.animation = 'fadeOut 0.5s ease-out forwards';

        setTimeout(() => {
          wishFormContainer.style.display = 'none';
          submitSuccess.style.display = 'block';

          // T·∫°o ph√°o hoa ƒÉn m·ª´ng
          for (let i = 0; i < 15; i++) {
            setTimeout(() => randomFirework(), i * 200);
          }
        }, 500);
      }, 1000);
    }

    // Cho ph√©p Enter ƒë·ªÉ g·ª≠i
    wishInput.addEventListener('keypress', (e) => {
      if (e.key === 'Enter' && !e.shiftKey) {
        e.preventDefault();
        submitBtn.click();
      }
    });

    // =============================================
    // H·ªÜ TH·ªêNG ·∫¢NH NG·∫™U NHI√äN (GIF, PNG, JPG, WEBP, LOTTIE)
    // =============================================

    // Danh s√°ch file ·∫£nh/animation trong th∆∞ m·ª•c images/
    // H·ªó tr·ª£: GIF, PNG, JPG, JPEG, WEBP, JSON (Lottie)
    const imageFiles = [
      { type: 'gif', src: 'images/cat_in_a_rocket.gif' },
      { type: 'gif', src: 'images/live-chatbot.gif' },
      { type: 'lottie', src: 'images/cat_show.json' },
      // { type: 'png', src: 'images/balloon.png' },
      // { type: 'jpg', src: 'images/cake.jpg' },
      // { type: 'lottie', src: 'images/star.json' },
      // Th√™m nhi·ªÅu file ·∫£nh (GIF, PNG, JPG, WEBP, Lottie JSON) t·∫°i ƒë√¢y...
    ];

    // T·∫°o ·∫£nh/animation bay ng·∫´u nhi√™n
    function createRandomImage() {
      const randomItem = imageFiles[Math.floor(Math.random() * imageFiles.length)];
      const size = 40 + Math.random() * 40;

      // Random v·ªã tr√≠ xu·∫•t hi·ªán: 0=tr√™n, 1=tr√°i, 2=ph·∫£i
      const entryPosition = Math.floor(Math.random() * 3);
      let startX, startY, endX, endY;

      switch (entryPosition) {
        case 0: // T·ª´ tr√™n xu·ªëng
          startX = Math.random() * 100;
          startY = -150;
          endX = startX + (Math.random() - 0.5) * 40;
          endY = 110;
          break;
        case 1: // T·ª´ tr√°i sang ph·∫£i
          startX = -150;
          startY = Math.random() * 80 + 10;
          endX = 110;
          endY = startY + (Math.random() - 0.5) * 30;
          break;
        case 2: // T·ª´ ph·∫£i sang tr√°i
          startX = 110;
          startY = Math.random() * 80 + 10;
          endX = -20;
          endY = startY + (Math.random() - 0.5) * 30;
          break;
      }

      let container;

      if (randomItem.type === 'lottie') {
        // T·∫°o Lottie animation
        container = document.createElement('div');
        container.className = 'random-image';
        container.style.cssText = `
          position: fixed;
          width: ${size}px;
          height: ${size}px;
          left: ${startX}${entryPosition === 0 ? 'vw' : 'px'};
          top: ${startY}${entryPosition === 0 ? 'px' : 'vh'};
          z-index: ${Math.floor(Math.random() * 50) + 10};
          pointer-events: none;
          opacity: ${0.7 + Math.random() * 0.3};
        `;

        document.body.appendChild(container);

        // Load Lottie animation
        try {
          lottie.loadAnimation({
            container: container,
            renderer: 'svg',
            loop: true,
            autoplay: true,
            path: randomItem.src
          });
        } catch (error) {
          console.error('Error loading Lottie:', error);
          container.remove();
          return;
        }
      } else {
        // T·∫°o ·∫£nh th∆∞·ªùng (GIF, PNG, JPG, WEBP)
        container = document.createElement('img');
        container.src = randomItem.src;
        container.className = 'random-image';
        container.style.cssText = `
          position: fixed;
          width: ${size}px;
          left: ${startX}${entryPosition === 0 ? 'vw' : 'px'};
          top: ${startY}${entryPosition === 0 ? 'px' : 'vh'};
          z-index: ${Math.floor(Math.random() * 50) + 10};
          pointer-events: none;
          border-radius: 5px;
          opacity: ${0.7 + Math.random() * 0.3};
        `;

        document.body.appendChild(container);
      }

      // Animation di chuy·ªÉn theo h∆∞·ªõng
      const duration = 8000 + Math.random() * 4000;
      const rotation = (Math.random() - 0.5) * 720; // Random xoay c·∫£ 2 h∆∞·ªõng
      const midRotation = rotation * 0.4;

      // T√≠nh to√°n v·ªã tr√≠ gi·ªØa v√† cu·ªëi
      const midX = startX + (endX - startX) * 0.5;
      const midY = startY + (endY - startY) * 0.5;

      // Random th√™m ƒë·ªô l·ªách ƒë·ªÉ t·∫°o ƒë∆∞·ªùng cong
      const curveOffset = (Math.random() - 0.5) * 100;

      container.animate([
        {
          left: `${startX}${entryPosition === 0 ? 'vw' : 'px'}`,
          top: `${startY}${entryPosition === 0 ? 'px' : 'vh'}`,
          transform: `rotate(0deg) scale(0.5)`,
          opacity: 0
        },
        {
          left: `${midX + curveOffset}${entryPosition === 0 ? 'vw' : entryPosition === 1 ? 'vw' : 'vw'}`,
          top: `${midY}${entryPosition === 0 ? 'vh' : 'vh'}`,
          transform: `rotate(${midRotation}deg) scale(1)`,
          opacity: container.style.opacity
        },
        {
          left: `${endX}${entryPosition === 0 ? 'vw' : entryPosition === 1 ? 'vw' : 'vw'}`,
          top: `${endY}${entryPosition === 0 ? 'vh' : 'vh'}`,
          transform: `rotate(${rotation}deg) scale(0.8)`,
          opacity: 0
        }
      ], {
        duration: duration,
        easing: 'ease-in-out'
      }).onfinish = () => container.remove();
    }

    // T·∫°o ·∫£nh li√™n t·ª•c
    const imageInterval = setInterval(createRandomImage, 800);
    for (let i = 0; i < 15; i++) {
      setTimeout(createRandomImage, i * 100);
    }

    // T·∫°o ·∫£nh bay ·ªü c√°c m√†n h√¨nh ƒë·∫∑c bi·ªát
    function createSpecialImage(count = 5) {
      for (let i = 0; i < count; i++) {
        setTimeout(createRandomImage, i * 200);
      }
    }

    // T·∫°o hi·ªáu ·ª©ng ph√°o hoa m·ªÅm m·∫°i
    function createFirework(x, y) {
      const container = document.createElement('div');
      container.className = 'firework-container';
      container.style.left = x + 'px';
      container.style.top = y + 'px';
      document.body.appendChild(container);

      const color = colors[Math.floor(Math.random() * colors.length)];
      const particles = 40; // TƒÉng t·ª´ 25 l√™n 40

      for (let i = 0; i < particles; i++) {
        const particle = document.createElement('div');
        particle.className = 'firework';
        particle.style.background = color;
        particle.style.color = color;

        const angle = (Math.PI * 2 * i) / particles;
        const velocity = 80 + Math.random() * 60; // TƒÉng v·∫≠n t·ªëc
        const tx = Math.cos(angle) * velocity;
        const ty = Math.sin(angle) * velocity;

        particle.style.setProperty('--tx', tx + 'px');
        particle.style.setProperty('--ty', ty + 'px');
        particle.style.animation = `explode ${1 + Math.random() * 0.5}s ease-out forwards`;

        container.appendChild(particle);
      }

      setTimeout(() => container.remove(), 2500);
    }

    // T·∫°o ph√°o hoa l·ªõn h∆°n
    function createBigFirework(x, y) {
      const container = document.createElement('div');
      container.className = 'firework-container';
      container.style.left = x + 'px';
      container.style.top = y + 'px';
      document.body.appendChild(container);

      const color = colors[Math.floor(Math.random() * colors.length)];
      const particles = 60; // Nhi·ªÅu h∆°n n·ªØa

      for (let i = 0; i < particles; i++) {
        const particle = document.createElement('div');
        particle.className = 'big-firework';
        particle.style.background = color;
        particle.style.color = color;

        const angle = (Math.PI * 2 * i) / particles;
        const velocity = 100 + Math.random() * 80;
        const tx = Math.cos(angle) * velocity;
        const ty = Math.sin(angle) * velocity;

        particle.style.setProperty('--tx', tx + 'px');
        particle.style.setProperty('--ty', ty + 'px');
        particle.style.animation = `bigExplode ${1.2 + Math.random() * 0.8}s ease-out forwards`;

        container.appendChild(particle);
      }

      setTimeout(() => container.remove(), 3000);
    }

    // T·∫°o ph√°o hoa ng·∫´u nhi√™n nh·∫π nh√†ng
    function randomFirework() {
      const x = Math.random() * window.innerWidth;
      const y = Math.random() * window.innerHeight * 0.5;
      // 50% c∆° h·ªôi t·∫°o ph√°o hoa l·ªõn
      if (Math.random() > 0.5) {
        createBigFirework(x, y);
      } else {
        createFirework(x, y);
      }
    }

    // B·∫Øn ph√°o hoa th∆∞·ªùng xuy√™n h∆°n
    setInterval(randomFirework, 1800); // Gi·∫£m t·ª´ 2500 xu·ªëng 1800
    setTimeout(randomFirework, 500);
    setTimeout(randomFirework, 1200);
    setTimeout(randomFirework, 2000);

    // =============================================
    // HI·ªÜU ·ª®NG N√ÇNG CAO CHO M√ÄN 1
    // =============================================

    // T·∫°o b√≥ng bay bay l√™n
    function createBalloons(count = 10) {
      for (let i = 0; i < count; i++) {
        setTimeout(() => {
          const balloon = document.createElement('div');
          balloon.className = 'balloon';
          const balloonColors = ['#FF6B9D', '#FFC75F', '#845EC2', '#00D2FC', '#FF6348', '#A8E6CF'];
          balloon.style.background = balloonColors[Math.floor(Math.random() * balloonColors.length)];
          balloon.style.left = Math.random() * window.innerWidth + 'px';
          balloon.style.animation = `float-up ${8 + Math.random() * 4}s ease-in-out forwards`;
          document.body.appendChild(balloon);

          setTimeout(() => balloon.remove(), 12000);
        }, i * 200);
      }
    }

    // T·∫°o confetti (gi·∫•y r∆°i)
    function createConfetti(count = 50) {
      const confettiColors = ['#FFD700', '#FF6B9D', '#845EC2', '#00D2FC', '#FF6348', '#A8E6CF', '#F38181'];

      for (let i = 0; i < count; i++) {
        const confetti = document.createElement('div');
        confetti.className = 'confetti';
        confetti.style.left = Math.random() * window.innerWidth + 'px';
        confetti.style.top = '-10px';
        confetti.style.background = confettiColors[Math.floor(Math.random() * confettiColors.length)];
        confetti.style.width = (Math.random() * 8 + 4) + 'px';
        confetti.style.height = (Math.random() * 8 + 4) + 'px';

        const duration = Math.random() * 2 + 3; // 3-5 gi√¢y
        const isFallingLeft = Math.random() > 0.5;

        confetti.style.animation = isFallingLeft
          ? `confetti-fall-left ${duration}s linear forwards`
          : `confetti-fall ${duration}s linear forwards`;

        document.body.appendChild(confetti);

        setTimeout(() => confetti.remove(), duration * 1000);
      }
    }

    // T·∫°o tia s√°ng (sparkles)
    function createSparkles(x, y, count = 15) {
      for (let i = 0; i < count; i++) {
        const sparkle = document.createElement('div');
        sparkle.className = 'sparkle';
        sparkle.style.left = x + 'px';
        sparkle.style.top = y + 'px';

        const sparkleColors = ['#FFD700', '#FFC75F', '#FF6B9D', '#00D2FC'];
        sparkle.style.background = sparkleColors[Math.floor(Math.random() * sparkleColors.length)];

        const angle = (Math.PI * 2 * i) / count;
        const distance = 30 + Math.random() * 50;
        const tx = Math.cos(angle) * distance;
        const ty = Math.sin(angle) * distance;

        sparkle.style.setProperty('--tx', tx + 'px');
        sparkle.style.setProperty('--ty', ty + 'px');

        const duration = Math.random() * 0.8 + 0.5;
        sparkle.style.animation = `sparkle-shine ${duration}s ease-out forwards`;

        document.body.appendChild(sparkle);

        setTimeout(() => sparkle.remove(), duration * 1000);
      }
    }

    // T·∫°o bong b√≥ng n·ªï
    function createBubbleBurst(x, y) {
      const burstColors = ['#FFD700', '#FF6B9D', '#845EC2', '#00D2FC'];

      for (let i = 0; i < 5; i++) {
        const bubble = document.createElement('div');
        bubble.className = 'burst-bubble';
        bubble.style.left = x + 'px';
        bubble.style.top = y + 'px';
        bubble.style.width = (30 + Math.random() * 20) + 'px';
        bubble.style.height = bubble.style.width;
        bubble.style.background = burstColors[Math.floor(Math.random() * burstColors.length)];
        bubble.style.animation = `bubble-burst ${0.6 + Math.random() * 0.4}s ease-out forwards`;

        document.body.appendChild(bubble);

        setTimeout(() => bubble.remove(), 1000);
      }
    }

    // T·∫°o hi·ªáu ·ª©ng emoji bay
    function createFlyingEmojis(emojis = ['üéâ', '‚ú®', 'üéÅ', 'üíù', 'üåü'], count = 5) {
      for (let i = 0; i < count; i++) {
        setTimeout(() => {
          const emoji = document.createElement('div');
          emoji.className = 'flying-emoji';
          emoji.textContent = emojis[Math.floor(Math.random() * emojis.length)];
          emoji.style.left = Math.random() * window.innerWidth + 'px';
          emoji.style.top = Math.random() * window.innerHeight * 0.5 + 'px';
          emoji.style.fontSize = (40 + Math.random() * 40) + 'px';
          emoji.style.animation = `emojifly ${6 + Math.random() * 4}s ease-in-out forwards`;

          document.body.appendChild(emoji);

          setTimeout(() => emoji.remove(), 10000);
        }, i * 300);
      }
    }

    // H√†m t·∫°o l√πm hoa (spray nhi·ªÅu hi·ªáu ·ª©ng)
    function createCelebrationSpray(x, y) {
      createFirework(x, y);
      createSparkles(x, y, 20);
      createBubbleBurst(x, y);
    }

    // Th√™m hi·ªáu ·ª©ng v√†o khi hi·ªÉn th·ªã m√†n 1 (greeting card)
    // T√¨m n∆°i goBtn.addEventListener k·∫øt th√∫c v√† th√™m v√†o ƒë√≥
    // (S·∫Ω th√™m ·ªü ph·∫ßn cu·ªëi)
  </script>
</body>

</html>